---
/**
 * Backgrounds Demo
 *
 * Page and component backgrounds beyond solid colors: gradients,
 * noise textures, glassmorphism, and animated backgrounds.
 */

import LabLayout from '../../../layouts/LabLayout.astro';

// Code examples as template strings
const meshGradientCode = `/* Mesh gradient - multiple radial overlays */
.mesh-bg {
  background:
    radial-gradient(at 40% 20%, hsla(28, 100%, 74%, 1) 0px, transparent 50%),
    radial-gradient(at 80% 0%, hsla(189, 100%, 56%, 1) 0px, transparent 50%),
    radial-gradient(at 0% 50%, hsla(355, 100%, 93%, 1) 0px, transparent 50%);
}

/* Animated gradient */
.animated-bg {
  background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
  background-size: 400% 400%;
  animation: gradient-shift 15s ease infinite;
}`;

const textureCode = `/* Noise texture via SVG data URI */
--texture-noise: url("data:image/svg+xml,...");

/* Apply texture overlay */
.surface::before {
  content: "";
  position: absolute;
  inset: 0;
  background: var(--texture-noise);
  opacity: var(--surface-texture-opacity);
  pointer-events: none;
}`;

const glassmorphismCode = `/* Glassmorphism card */
.glass-card {
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(var(--glass-blur, 8px));
  -webkit-backdrop-filter: blur(var(--glass-blur, 8px));
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: var(--radius-m);
}`;
---

<LabLayout
  title="Backgrounds & Surfaces"
  description="Page and component backgrounds beyond solid colors: gradients, textures, glassmorphism."
>
  <nav class="breadcrumb" aria-label="Breadcrumb">
    <a href="/lab/">Lab</a> / <a href="/lab/theme-extensions/">Theme Extensions</a> / <span aria-current="page">Backgrounds</span>
  </nav>

  <h1>Backgrounds & Surfaces</h1>
  <p class="lead">Exploring page and component background treatments beyond solid colors: gradients, textures, glassmorphism, and animated backgrounds.</p>

  <section>
    <h2>Proposed Surface Tokens</h2>
    <p>New tokens to add texture and depth to surfaces.</p>
    <table class="props-table">
      <thead>
        <tr>
          <th>Token</th>
          <th>Values</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>--surface-texture</code></td>
          <td><code>none | noise | grain | dots | lines</code></td>
        </tr>
        <tr>
          <td><code>--surface-texture-opacity</code></td>
          <td><code>0.05</code> (default)</td>
        </tr>
        <tr>
          <td><code>--bg-gradient</code></td>
          <td><code>linear-gradient(...)</code></td>
        </tr>
        <tr>
          <td><code>--glass-blur</code></td>
          <td><code>0 | 8px | 16px</code></td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>Gradient Backgrounds</h2>
    <p>Various gradient techniques for hero sections, cards, and page backgrounds.</p>
    <browser-window url="gradient-demo">
      <div class="gradient-grid">
        <div class="gradient-card gradient-linear">
          <h3>Linear</h3>
          <p>135deg diagonal blend</p>
        </div>
        <div class="gradient-card gradient-radial">
          <h3>Radial</h3>
          <p>Circle from top-left</p>
        </div>
        <div class="gradient-card gradient-conic">
          <h3>Conic</h3>
          <p>Color wheel effect</p>
        </div>
        <div class="gradient-card gradient-mesh">
          <h3>Mesh</h3>
          <p>Multiple radial overlays</p>
        </div>
        <div class="gradient-card gradient-animated">
          <h3>Animated</h3>
          <p>Shifting background position</p>
        </div>
        <div class="gradient-card gradient-layered">
          <h3>Layered</h3>
          <p>Highlight + base gradient</p>
        </div>
      </div>
    </browser-window>
    <code-block language="css" label="Gradient techniques">{meshGradientCode}</code-block>
  </section>

  <section>
    <h2>Texture Patterns</h2>
    <p>Subtle texture overlays that add depth and character to surfaces.</p>
    <browser-window url="texture-demo">
      <div class="texture-grid">
        <div class="texture-card texture-none">
          <h3>None</h3>
          <p>Clean, flat surface</p>
        </div>
        <div class="texture-card texture-noise">
          <h3>Noise</h3>
          <p>SVG turbulence filter</p>
        </div>
        <div class="texture-card texture-dots">
          <h3>Dots</h3>
          <p>Repeating dot pattern</p>
        </div>
        <div class="texture-card texture-grid-pattern">
          <h3>Grid</h3>
          <p>Diagonal grid lines</p>
        </div>
        <div class="texture-card texture-lines">
          <h3>Lines</h3>
          <p>Fine diagonal lines</p>
        </div>
        <div class="texture-card texture-grain">
          <h3>Grain</h3>
          <p>Film grain effect</p>
        </div>
      </div>
    </browser-window>
    <code-block language="css" label="Texture overlay technique">{textureCode}</code-block>
  </section>

  <section>
    <h2>Glassmorphism</h2>
    <p>Frosted glass effect using backdrop-filter. Adjust the blur amount with the slider.</p>
    <browser-window url="glassmorphism-demo">
      <div class="glass-demo">
        <div class="glass-cards">
          <div class="glass-card">
            <h3>Glass Card</h3>
            <p>Semi-transparent with blur backdrop</p>
          </div>
          <div class="glass-card">
            <h3>Frosted</h3>
            <p>Works best on colorful backgrounds</p>
          </div>
          <div class="glass-card">
            <h3>Layered</h3>
            <p>Border adds subtle definition</p>
          </div>
        </div>
      </div>
    </browser-window>
    <div class="glass-controls">
      <label>
        Blur: <span id="blur-value">8px</span>
        <input type="range" id="glass-blur" min="0" max="32" value="8">
      </label>
    </div>
    <code-block language="css" label="Glassmorphism card">{glassmorphismCode}</code-block>
  </section>

  <section>
    <h2>Animated Gradients</h2>
    <p>Subtle movement for hero sections and featured content.</p>
    <browser-window url="animated-gradients">
      <div class="animated-gradient-demo">
        <div class="animated-card gradient-hue-rotate">
          <h3>Hue Rotate</h3>
          <p>Filter-based color cycling</p>
        </div>
        <div class="animated-card gradient-pulse">
          <h3>Pulse Glow</h3>
          <p>Breathing radial highlight</p>
        </div>
        <div class="animated-card gradient-wave">
          <h3>Wave</h3>
          <p>Rotating ellipse overlay</p>
        </div>
      </div>
    </browser-window>
  </section>

  <section>
    <h2>Page Background Preview</h2>
    <p>Test different page-level background treatments.</p>
    <browser-window url="page-background">
      <div class="page-bg-demo" data-bg="solid" id="page-bg-demo">
        <div class="page-bg-content">
          <div class="page-bg-card">
            <h3>Content Card</h3>
            <p>This card floats above the page background. Try different backgrounds to see how they affect the overall feel.</p>
          </div>
        </div>
      </div>
    </browser-window>
    <div class="bg-controls">
      <button data-bg="solid" aria-pressed="true">Solid</button>
      <button data-bg="gradient" aria-pressed="false">Gradient</button>
      <button data-bg="radial" aria-pressed="false">Radial</button>
      <button data-bg="noise" aria-pressed="false">Noise</button>
    </div>
  </section>
</LabLayout>

<style>
  /* Gradient Grid */
  .gradient-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: var(--size-m);
    padding: var(--size-m);
  }

  .gradient-card {
    padding: var(--size-l);
    border-radius: var(--radius-m);
    min-height: 140px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    color: white;
  }

  .gradient-card h3 {
    margin: 0 0 var(--size-xs) 0;
    font-size: var(--font-size-lg);
  }

  .gradient-card p {
    margin: 0;
    opacity: 0.8;
    font-size: var(--font-size-sm);
  }

  /* Gradient types */
  .gradient-linear {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .gradient-radial {
    background: radial-gradient(circle at 30% 30%, #ff6b6b 0%, #c44569 100%);
  }

  .gradient-conic {
    background: conic-gradient(from 45deg, #12c2e9, #c471ed, #f64f59, #12c2e9);
  }

  .gradient-mesh {
    background:
      radial-gradient(at 40% 20%, hsla(28, 100%, 74%, 1) 0px, transparent 50%),
      radial-gradient(at 80% 0%, hsla(189, 100%, 56%, 1) 0px, transparent 50%),
      radial-gradient(at 0% 50%, hsla(355, 100%, 93%, 1) 0px, transparent 50%),
      radial-gradient(at 80% 50%, hsla(340, 100%, 76%, 1) 0px, transparent 50%),
      radial-gradient(at 0% 100%, hsla(22, 100%, 77%, 1) 0px, transparent 50%),
      radial-gradient(at 80% 100%, hsla(242, 100%, 70%, 1) 0px, transparent 50%),
      radial-gradient(at 0% 0%, hsla(343, 100%, 76%, 1) 0px, transparent 50%);
    color: #333;
  }

  .gradient-animated {
    background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
    background-size: 400% 400%;
    animation: gradient-shift 15s ease infinite;
  }

  @keyframes gradient-shift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .gradient-layered {
    background:
      linear-gradient(135deg, transparent 40%, rgba(255, 255, 255, 0.3) 100%),
      linear-gradient(45deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
  }

  /* Texture Grid */
  .texture-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: var(--size-m);
    padding: var(--size-m);
  }

  .texture-card {
    padding: var(--size-l);
    border-radius: var(--radius-m);
    min-height: 120px;
    position: relative;
    overflow: hidden;
  }

  .texture-card::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
  }

  .texture-card h3 {
    margin: 0 0 var(--size-xs) 0;
    font-size: var(--font-size-base);
    position: relative;
  }

  .texture-card p {
    margin: 0;
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    position: relative;
  }

  /* Texture types */
  .texture-none {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
  }
  .texture-none::before {
    display: none;
  }

  .texture-noise {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
  }
  .texture-noise::before {
    background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    opacity: 0.5;
  }

  .texture-dots {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
  }
  .texture-dots::before {
    background-image: radial-gradient(circle, #666 1px, transparent 1px);
    background-size: 8px 8px;
    opacity: 0.3;
  }

  .texture-grid-pattern {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
  }
  .texture-grid-pattern::before {
    background-image:
      linear-gradient(to right, #999 1px, transparent 1px),
      linear-gradient(to bottom, #999 1px, transparent 1px);
    background-size: 20px 20px;
    opacity: 0.2;
  }

  .texture-lines {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
  }
  .texture-lines::before {
    background-image: repeating-linear-gradient(
      45deg,
      transparent,
      transparent 4px,
      #999 4px,
      #999 5px
    );
    opacity: 0.15;
  }

  .texture-grain {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
  }
  .texture-grain::before {
    background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.2' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    opacity: 0.4;
    mix-blend-mode: multiply;
  }

  /* Glassmorphism */
  .glass-demo {
    position: relative;
    padding: var(--size-2xl);
    border-radius: var(--radius-l);
    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
    min-height: 300px;
    overflow: hidden;
  }

  .glass-demo::before {
    content: "";
    position: absolute;
    inset: 0;
    background:
      radial-gradient(circle at 20% 30%, rgba(255,255,255,0.3) 0, transparent 200px),
      radial-gradient(circle at 80% 70%, rgba(255,255,255,0.2) 0, transparent 300px);
    pointer-events: none;
  }

  .glass-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: var(--size-m);
    position: relative;
  }

  .glass-card {
    padding: var(--size-l);
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(var(--glass-blur, 8px));
    -webkit-backdrop-filter: blur(var(--glass-blur, 8px));
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-m);
    color: white;
  }

  .glass-card h3 {
    margin: 0 0 var(--size-xs) 0;
  }

  .glass-card p {
    margin: 0;
    opacity: 0.9;
    font-size: var(--font-size-sm);
  }

  .glass-controls {
    display: flex;
    gap: var(--size-m);
    margin-top: var(--size-m);
  }

  .glass-controls label {
    display: flex;
    align-items: center;
    gap: var(--size-s);
    font-size: var(--font-size-sm);
  }

  .glass-controls input[type="range"] {
    width: 150px;
  }

  /* Animated Gradients */
  .animated-gradient-demo {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: var(--size-m);
    padding: var(--size-m);
  }

  .animated-card {
    padding: var(--size-l);
    border-radius: var(--radius-m);
    min-height: 140px;
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
  }

  .animated-card h3 {
    margin: 0 0 var(--size-xs) 0;
  }

  .animated-card p {
    margin: 0;
    opacity: 0.8;
    font-size: var(--font-size-sm);
  }

  /* Hue rotate */
  .gradient-hue-rotate {
    background: linear-gradient(135deg, hsl(200, 80%, 50%), hsl(280, 80%, 50%));
    animation: hue-rotate 10s linear infinite;
  }

  @keyframes hue-rotate {
    to { filter: hue-rotate(360deg); }
  }

  /* Pulse glow */
  .gradient-pulse {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    position: relative;
    overflow: hidden;
  }

  .gradient-pulse::before {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 50% 50%, rgba(102, 126, 234, 0.4) 0%, transparent 60%);
    animation: pulse-glow 3s ease-in-out infinite;
  }

  @keyframes pulse-glow {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.2); }
  }

  /* Wave */
  .gradient-wave {
    background: linear-gradient(135deg, #0f3460 0%, #16213e 100%);
    position: relative;
    overflow: hidden;
  }

  .gradient-wave::before,
  .gradient-wave::after {
    content: "";
    position: absolute;
    inset: -50%;
    background: radial-gradient(ellipse, rgba(102, 126, 234, 0.3) 0%, transparent 70%);
    animation: wave 8s linear infinite;
  }

  .gradient-wave::after {
    animation-delay: -4s;
    opacity: 0.5;
  }

  @keyframes wave {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  /* Page Background Preview */
  .page-bg-demo {
    position: relative;
    min-height: 250px;
    border-radius: var(--radius-l);
    overflow: hidden;
    border: 1px solid var(--color-border);
  }

  .page-bg-demo[data-bg="solid"] {
    background: #f8fafc;
  }

  .page-bg-demo[data-bg="gradient"] {
    background: linear-gradient(180deg, #e0e7ff 0%, #fce7f3 50%, #fef3c7 100%);
  }

  .page-bg-demo[data-bg="radial"] {
    background: radial-gradient(ellipse at 50% 0%, #c7d2fe 0%, #f8fafc 70%);
  }

  .page-bg-demo[data-bg="noise"] {
    background: #f1f5f9;
  }

  .page-bg-demo[data-bg="noise"]::before {
    content: "";
    position: absolute;
    inset: 0;
    background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    opacity: 0.15;
    pointer-events: none;
  }

  .page-bg-content {
    position: relative;
    padding: var(--size-l);
  }

  .page-bg-card {
    max-width: 350px;
    margin: 0 auto;
    padding: var(--size-l);
    background: var(--color-surface-raised, var(--color-surface));
    border: 1px solid var(--color-border);
    border-radius: var(--radius-m);
    box-shadow: var(--shadow-md, 0 4px 6px rgba(0,0,0,0.1));
  }

  .page-bg-card h3 {
    margin: 0 0 var(--size-xs) 0;
  }

  .page-bg-card p {
    margin: 0;
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
  }

  .bg-controls {
    display: flex;
    flex-wrap: wrap;
    gap: var(--size-xs);
    margin-top: var(--size-m);
  }

  .bg-controls button {
    padding: var(--size-xs) var(--size-s);
    background: var(--color-surface);
    color: var(--color-text);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-s);
    font-size: var(--font-size-sm);
    cursor: pointer;
    font-family: inherit;
    transition: background 0.15s ease, border-color 0.15s ease;
  }

  .bg-controls button:hover {
    background: var(--color-surface-alt);
    border-color: var(--color-border-strong, var(--color-border));
  }

  .bg-controls button[aria-pressed="true"] {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .gradient-animated,
    .gradient-hue-rotate,
    .gradient-pulse::before,
    .gradient-wave::before,
    .gradient-wave::after {
      animation: none;
    }
  }
</style>

<script>
  // Glass blur control
  const glassBlur = document.getElementById('glass-blur') as HTMLInputElement;
  const blurValue = document.getElementById('blur-value');

  glassBlur?.addEventListener('input', () => {
    const value = glassBlur.value;
    if (blurValue) blurValue.textContent = `${value}px`;
    document.documentElement.style.setProperty('--glass-blur', `${value}px`);
  });

  // Page background controls
  const pageBgDemo = document.getElementById('page-bg-demo');
  const bgButtons = document.querySelectorAll('.bg-controls button');

  bgButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      bgButtons.forEach(b => b.setAttribute('aria-pressed', 'false'));
      btn.setAttribute('aria-pressed', 'true');
      if (pageBgDemo && btn instanceof HTMLElement) {
        pageBgDemo.dataset.bg = btn.dataset.bg || 'solid';
      }
    });
  });
</script>
