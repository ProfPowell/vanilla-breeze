---
/**
 * R&D Catch-All Route
 *
 * Serves zen-garden experiments directly from the r-n-d directory.
 * This allows viewing experimental patterns without a separate server.
 */

import { readFile } from 'fs/promises';
import { join } from 'path';

export const prerender = false;

const { path } = Astro.params;

// Default to index.html if no path provided
const filePath = join(process.cwd(), 'r-n-d', 'zen-garden', path || 'index.html');

let content: string;
let contentType = 'text/html';

// Determine content type based on extension
const ext = filePath.split('.').pop()?.toLowerCase();
switch (ext) {
  case 'css':
    contentType = 'text/css';
    break;
  case 'js':
    contentType = 'text/javascript';
    break;
  case 'json':
    contentType = 'application/json';
    break;
  case 'svg':
    contentType = 'image/svg+xml';
    break;
  case 'png':
    contentType = 'image/png';
    break;
  case 'jpg':
  case 'jpeg':
    contentType = 'image/jpeg';
    break;
}

try {
  content = await readFile(filePath, 'utf-8');
} catch (e) {
  return new Response('Not found', { status: 404 });
}

// For HTML files, serve as HTML page
if (contentType === 'text/html') {
  // Return HTML directly
}
---

<Fragment set:html={content} />
