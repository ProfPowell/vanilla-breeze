---
/**
 * Track (<track>) Element Documentation
 *
 * The track element provides timed text tracks for video and audio elements,
 * enabling captions, subtitles, descriptions, and chapter markers.
 */
import ElementLayout from '../../../../layouts/ElementLayout.astro';

// Code examples as template strings
const captionsVsSubtitlesCode = `<video controls>
  <source src="movie.mp4" type="video/mp4" />

  <!-- Captions for deaf/hard-of-hearing -->
  <track
    kind="captions"
    src="captions-en.vtt"
    srclang="en"
    label="English captions"
    default />

  <!-- Subtitles for non-English speakers -->
  <track
    kind="subtitles"
    src="subtitles-es.vtt"
    srclang="es"
    label="Spanish" />

  <track
    kind="subtitles"
    src="subtitles-fr.vtt"
    srclang="fr"
    label="French" />
</video>`;

const webvttBasicCode = `WEBVTT

00:00:01.000 --> 00:00:04.000
Hello, and welcome to this tutorial.

00:00:05.000 --> 00:00:08.500
Today we'll learn about HTML video captions.

00:00:09.000 --> 00:00:12.000
Let's get started!`;

const webvttSpeakerCode = `WEBVTT

00:00:01.000 --> 00:00:03.500
<v Host>Welcome to the show!</v>

00:00:04.000 --> 00:00:06.500
<v Guest>Thanks for having me.</v>`;

const webvttSoundEffectsCode = `WEBVTT

00:00:01.000 --> 00:00:03.000
[suspenseful music]

00:00:03.500 --> 00:00:05.000
[door creaks open]

00:00:05.500 --> 00:00:08.000
Who's there?`;

const webvttPositioningCode = `WEBVTT

00:00:01.000 --> 00:00:04.000 line:90% position:50% align:center
Centered at bottom

00:00:05.000 --> 00:00:08.000 line:10% position:10% align:left
Top left corner`;

const webvttChaptersCode = `WEBVTT

chapter-1
00:00:00.000 --> 00:02:30.000
Introduction

chapter-2
00:02:30.000 --> 00:08:15.000
Getting Started

chapter-3
00:08:15.000 --> 00:15:00.000
Advanced Topics

chapter-4
00:15:00.000 --> 00:20:00.000
Conclusion`;

const trackAttributesCode = `<track
  kind="captions"
  src="captions.vtt"
  srclang="en"
  label="English"
  default />`;

const multipleTracksCode = `<video controls>
  <source src="presentation.mp4" type="video/mp4" />

  <!-- Captions -->
  <track
    kind="captions"
    src="captions-en.vtt"
    srclang="en"
    label="English captions"
    default />

  <!-- Subtitles in other languages -->
  <track
    kind="subtitles"
    src="subtitles-es.vtt"
    srclang="es"
    label="Espanol" />

  <track
    kind="subtitles"
    src="subtitles-zh.vtt"
    srclang="zh"
    label="Chinese" />

  <!-- Audio descriptions for blind users -->
  <track
    kind="descriptions"
    src="descriptions-en.vtt"
    srclang="en"
    label="Audio descriptions" />

  <!-- Chapter markers -->
  <track
    kind="chapters"
    src="chapters-en.vtt"
    srclang="en"
    label="Chapters" />
</video>`;

const audioCaptionsCode = `<audio controls>
  <source src="podcast.mp3" type="audio/mpeg" />

  <track
    kind="captions"
    src="podcast-captions.vtt"
    srclang="en"
    label="Transcript"
    default />
</audio>`;

const trackApiCode = `const video = document.querySelector('video');
const track = video.textTracks[0];

// Listen for cue changes
track.oncuechange = function() {
  const activeCues = track.activeCues;
  if (activeCues.length > 0) {
    console.log('Current caption:', activeCues[0].text);
  }
};

// Show/hide tracks programmatically
track.mode = 'showing';  // Show captions
track.mode = 'hidden';   // Load but don't display
track.mode = 'disabled'; // Don't load`;

const customCaptionDisplayCode = `<video id="myVideo" controls>
  <source src="video.mp4" type="video/mp4" />
  <track kind="captions" src="captions.vtt" srclang="en" default />
</video>
<div id="custom-captions"></div>

<script>
const video = document.getElementById('myVideo');
const captionDisplay = document.getElementById('custom-captions');

video.textTracks[0].mode = 'hidden';

video.textTracks[0].oncuechange = function() {
  const cue = this.activeCues[0];
  captionDisplay.textContent = cue ? cue.text : '';
};
</script>`;

const cssStylingCode = `/* Style video captions */
video::cue {
  background: rgba(0, 0, 0, 0.8);
  color: white;
  font-family: system-ui, sans-serif;
  font-size: 1rem;
}

/* Style specific voices */
video::cue(v[voice="Host"]) {
  color: yellow;
}

/* Hide track element (precautionary) */
track {
  display: none;
}`;
---

<ElementLayout
  title="track"
  description="The track element provides timed text tracks for video and audio elements, enabling captions, subtitles, descriptions, and chapter markers."
  elementName="track"
  category="native"
  nativeGroup="Media"
  currentPath="/docs/elements/native/track/"
>
  <section>
    <h2>Description</h2>
    <p>The <code>&lt;track&gt;</code> element specifies timed text tracks (in WebVTT format) for <code>&lt;video&gt;</code> and <code>&lt;audio&gt;</code> elements. These tracks provide captions for deaf users, subtitles for foreign languages, audio descriptions for blind users, and chapter navigation.</p>

    <p>Tracks are essential for accessibility and are required by many accessibility standards (WCAG) for video content with audio.</p>
  </section>

  <section>
    <h2>When to Use</h2>
    <ul>
      <li><strong>Captions</strong> - Transcription of dialogue plus descriptions of important sounds</li>
      <li><strong>Subtitles</strong> - Translation of dialogue into another language</li>
      <li><strong>Descriptions</strong> - Audio descriptions of visual content for blind users</li>
      <li><strong>Chapters</strong> - Navigation markers for longer videos</li>
      <li><strong>Metadata</strong> - Machine-readable data synchronized with media</li>
    </ul>
  </section>

  <section>
    <h2>Track Kinds</h2>

    <table class="props-table">
      <thead>
        <tr>
          <th>Kind</th>
          <th>Purpose</th>
          <th>Display</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>captions</code></td>
          <td>Dialogue + sound effects for deaf/hard-of-hearing</td>
          <td>Shown over video</td>
        </tr>
        <tr>
          <td><code>subtitles</code></td>
          <td>Translation of spoken dialogue</td>
          <td>Shown over video</td>
        </tr>
        <tr>
          <td><code>descriptions</code></td>
          <td>Audio descriptions of visual content</td>
          <td>Synthesized speech or separate audio</td>
        </tr>
        <tr>
          <td><code>chapters</code></td>
          <td>Chapter titles for navigation</td>
          <td>In browser UI/controls</td>
        </tr>
        <tr>
          <td><code>metadata</code></td>
          <td>Machine-readable data</td>
          <td>Not displayed (JavaScript access)</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>Captions vs Subtitles</h2>

    <h3>Captions</h3>
    <p>Designed for deaf and hard-of-hearing users. Include:</p>
    <ul>
      <li>All spoken dialogue</li>
      <li>Speaker identification when not obvious</li>
      <li>Sound effects: [door slams], [phone rings]</li>
      <li>Music descriptions: [upbeat jazz music]</li>
      <li>Non-verbal sounds: [sighs], [laughs]</li>
    </ul>

    <h3>Subtitles</h3>
    <p>Designed for users who can hear but don't understand the spoken language. Include:</p>
    <ul>
      <li>Translation of spoken dialogue</li>
      <li>Assume user can hear non-speech audio</li>
    </ul>

    <code-block language="html" show-lines label="Captions vs subtitles">{captionsVsSubtitlesCode}</code-block>
  </section>

  <section>
    <h2>WebVTT Format</h2>
    <p>Track files use the WebVTT (Web Video Text Tracks) format.</p>

    <h3>Basic Structure</h3>
    <code-block language="html" show-lines label="WebVTT basic format">{webvttBasicCode}</code-block>

    <h3>With Speaker Identification</h3>
    <code-block language="html" show-lines label="WebVTT with speaker identification">{webvttSpeakerCode}</code-block>

    <h3>With Sound Effects</h3>
    <code-block language="html" show-lines label="WebVTT with sound effects">{webvttSoundEffectsCode}</code-block>

    <h3>Positioning and Styling</h3>
    <code-block language="html" show-lines label="WebVTT with positioning">{webvttPositioningCode}</code-block>

    <h3>Chapter Markers</h3>
    <code-block language="html" show-lines label="WebVTT chapter markers">{webvttChaptersCode}</code-block>
  </section>

  <section>
    <h2>Attributes</h2>

    <table class="props-table">
      <thead>
        <tr>
          <th>Attribute</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>src</code></td>
          <td>URL of the track file (.vtt)</td>
        </tr>
        <tr>
          <td><code>kind</code></td>
          <td><code>captions</code>, <code>subtitles</code>, <code>descriptions</code>, <code>chapters</code>, or <code>metadata</code></td>
        </tr>
        <tr>
          <td><code>srclang</code></td>
          <td>Language of the track (BCP 47 language tag)</td>
        </tr>
        <tr>
          <td><code>label</code></td>
          <td>User-readable title shown in track selection</td>
        </tr>
        <tr>
          <td><code>default</code></td>
          <td>Enable this track by default</td>
        </tr>
      </tbody>
    </table>

    <code-block language="html" show-lines label="Track element attributes">{trackAttributesCode}</code-block>
  </section>

  <section>
    <h2>Live Examples</h2>

    <h3>Video with Multiple Tracks</h3>
    <code-block language="html" show-lines label="Video with multiple track types">{multipleTracksCode}</code-block>

    <h3>Audio with Captions</h3>
    <p>Tracks can also be used with audio elements, though browser support varies.</p>
    <code-block language="html" show-lines label="Audio with captions">{audioCaptionsCode}</code-block>
  </section>

  <section>
    <h2>JavaScript API</h2>
    <p>Access track data programmatically for custom displays or metadata processing.</p>

    <code-block language="javascript" show-lines label="Track API basics">{trackApiCode}</code-block>

    <h3>Custom Caption Display</h3>
    <code-block language="html" show-lines label="Custom caption display">{customCaptionDisplayCode}</code-block>
  </section>

  <section>
    <h2>Accessibility</h2>

    <h3>WCAG Requirements</h3>
    <p>Web Content Accessibility Guidelines require captions and audio descriptions:</p>

    <table class="props-table">
      <thead>
        <tr>
          <th>Criterion</th>
          <th>Level</th>
          <th>Requirement</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1.2.2 Captions (Prerecorded)</td>
          <td>A</td>
          <td>Captions for all prerecorded audio in video</td>
        </tr>
        <tr>
          <td>1.2.3 Audio Description or Media Alternative</td>
          <td>A</td>
          <td>Audio description or text alternative for video</td>
        </tr>
        <tr>
          <td>1.2.4 Captions (Live)</td>
          <td>AA</td>
          <td>Captions for live audio in video</td>
        </tr>
        <tr>
          <td>1.2.5 Audio Description (Prerecorded)</td>
          <td>AA</td>
          <td>Audio description for prerecorded video</td>
        </tr>
      </tbody>
    </table>

    <h3>Best Practices</h3>
    <ul>
      <li>Always provide captions for videos with speech</li>
      <li>Use <code>kind="captions"</code> for deaf/hard-of-hearing users</li>
      <li>Use <code>kind="subtitles"</code> for translations only</li>
      <li>Include sound effects and speaker identification in captions</li>
      <li>Ensure caption timing matches audio accurately</li>
      <li>Provide a text transcript as an additional option</li>
      <li>Test captions with actual users</li>
    </ul>

    <h3>Caption Quality</h3>
    <ul>
      <li>Synchronize captions to within 1 second of audio</li>
      <li>Don't exceed 2 lines per caption</li>
      <li>Keep captions on screen long enough to read (minimum 1 second)</li>
      <li>Use standard punctuation and grammar</li>
      <li>Indicate speaker changes clearly</li>
    </ul>
  </section>

  <section>
    <h2>Related Elements</h2>
    <ul>
      <li><a href="/docs/elements/native/video/"><code>&lt;video&gt;</code></a> - Video player that accepts track elements</li>
      <li><a href="/docs/elements/native/audio/"><code>&lt;audio&gt;</code></a> - Audio player that accepts track elements</li>
      <li><a href="/docs/elements/native/source/"><code>&lt;source&gt;</code></a> - Media sources for video/audio</li>
    </ul>
  </section>

  <section>
    <h2>CSS Reference</h2>
    <p>The <code>&lt;track&gt;</code> element is not rendered directly. Caption styling is controlled via the <code>::cue</code> pseudo-element.</p>

    <code-block language="css" show-lines label="Caption styling with ::cue">{cssStylingCode}</code-block>
  </section>
</ElementLayout>
