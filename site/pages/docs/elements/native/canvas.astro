---
/**
 * Canvas (<canvas>) Element Documentation
 *
 * The canvas element provides a drawing surface for rendering graphics,
 * charts, games, and dynamic visual content via JavaScript.
 */
import ElementLayout from '../../../../layouts/ElementLayout.astro';

// Code examples as template strings
const basicCanvasCode = `<canvas width="300" height="150"></canvas>`;

const borderedCanvasCode = `<canvas class="bordered" width="300" height="150"></canvas>`;

const loadingCanvasCode = `<canvas class="bordered loading" width="300" height="150"></canvas>`;

const interactiveCanvasCode = `<canvas class="interactive" width="300" height="150"></canvas>`;

const drawingCanvasCode = `<canvas class="drawing" width="300" height="150"></canvas>`;

const responsiveCanvasCode = `<div class="canvas-responsive">
  <canvas></canvas>
</div>`;

const customAspectCode = `<!-- Square canvas -->
<div class="canvas-responsive" style="aspect-ratio: 1;">
  <canvas></canvas>
</div>

<!-- 4:3 canvas -->
<div class="canvas-responsive" style="aspect-ratio: 4 / 3;">
  <canvas></canvas>
</div>`;

const sizingCode = `<!-- Drawing buffer is 600x400 pixels -->
<!-- Display size is 300x200 CSS pixels (for retina) -->
<canvas width="600" height="400" style="inline-size: 300px; block-size: 200px;">
</canvas>`;

const retinaCode = `// Scale canvas for retina displays
const canvas = document.querySelector('canvas');
const ctx = canvas.getContext('2d');
const dpr = window.devicePixelRatio || 1;

// Set display size
canvas.style.width = '300px';
canvas.style.height = '200px';

// Set actual size in memory (scaled for DPI)
canvas.width = 300 * dpr;
canvas.height = 200 * dpr;

// Scale context to match
ctx.scale(dpr, dpr);`;

const basicDrawingCode = `const canvas = document.getElementById('example-basic');
const ctx = canvas.getContext('2d');

// Fill rectangle
ctx.fillStyle = '#4a90d9';
ctx.fillRect(20, 20, 150, 100);

// Stroke rectangle
ctx.strokeStyle = '#333';
ctx.lineWidth = 2;
ctx.strokeRect(200, 20, 150, 100);

// Draw text
ctx.fillStyle = '#333';
ctx.font = '16px system-ui';
ctx.fillText('Canvas Demo', 20, 160);`;

const fallbackCode = `<canvas width="400" height="300">
  <!-- Fallback for screen readers and non-canvas browsers -->
  <p>Bar chart showing quarterly sales:</p>
  <ul>
    <li>Q1: $45,000</li>
    <li>Q2: $52,000</li>
    <li>Q3: $48,000</li>
    <li>Q4: $61,000</li>
  </ul>
</canvas>`;

const ariaLabelCode = `<canvas
  role="img"
  aria-label="Line chart showing website traffic increasing 25% over six months"
  width="400"
  height="300">
</canvas>`;

const dataTableCode = `<figure>
  <canvas id="sales-chart" width="600" height="400"></canvas>
  <figcaption>
    Annual sales by region.
    <a href="#sales-table">View data table</a>
  </figcaption>
</figure>

<table id="sales-table">
  <!-- Accessible data table with same information -->
</table>`;
---

<ElementLayout
  title="canvas"
  description="The canvas element provides a drawing surface for rendering graphics, charts, games, and dynamic visual content via JavaScript."
  elementName="canvas"
  category="native"
  nativeGroup="Embedded"
  currentPath="/docs/elements/native/canvas/"
>
  <section>
    <h2>Description</h2>
    <p>The <code>&lt;canvas&gt;</code> element is a container for scriptable graphics. It provides a bitmap drawing surface that you can manipulate with JavaScript using either the 2D rendering context or WebGL for 3D graphics.</p>
    <p>Vanilla Breeze styles canvas elements to be block-level and responsive by default, with variants for borders, loading states, and interactive cursors.</p>
  </section>

  <section>
    <h2>When to Use</h2>
    <ul>
      <li><strong>Charts and graphs</strong> - Data visualization (often via libraries like Chart.js)</li>
      <li><strong>Games</strong> - 2D and 3D game rendering</li>
      <li><strong>Image manipulation</strong> - Filters, cropping, compositing</li>
      <li><strong>Animations</strong> - Complex animations beyond CSS capabilities</li>
      <li><strong>Drawing applications</strong> - User-interactive drawing tools</li>
      <li><strong>Signatures</strong> - Capture user signatures</li>
    </ul>

    <h3>When to Use Other Elements</h3>
    <ul>
      <li>Use <a href="/docs/elements/native/svg/"><code>&lt;svg&gt;</code></a> for scalable, accessible vector graphics</li>
      <li>Use <a href="/docs/elements/native/img/"><code>&lt;img&gt;</code></a> for static images</li>
      <li>Use CSS animations for simple, declarative animations</li>
      <li>Use <a href="/docs/elements/native/video/"><code>&lt;video&gt;</code></a> for pre-recorded animated content</li>
    </ul>
  </section>

  <section>
    <h2>Variants</h2>

    <h3>Default</h3>
    <p>Basic canvas without styling.</p>
    <div class="example">
      <canvas width="300" height="150" style="background: var(--color-surface-raised);"></canvas>
    </div>
    <code-block language="html" label="Basic canvas element">{basicCanvasCode}</code-block>

    <h3>.bordered</h3>
    <p>Adds a subtle border to define the canvas boundary.</p>
    <div class="example">
      <canvas class="bordered" width="300" height="150" style="background: var(--color-surface-raised);"></canvas>
    </div>
    <code-block language="html" label="Canvas with border">{borderedCanvasCode}</code-block>

    <h3>.loading</h3>
    <p>Striped pattern indicates loading or placeholder state before content is rendered.</p>
    <div class="example">
      <canvas class="bordered loading" width="300" height="150"></canvas>
    </div>
    <code-block language="html" label="Canvas with loading state">{loadingCanvasCode}</code-block>

    <h3>.interactive</h3>
    <p>Crosshair cursor for interactive canvases where users can click or draw.</p>
    <div class="example">
      <canvas class="bordered interactive" width="300" height="150" style="background: var(--color-surface-raised);"></canvas>
    </div>
    <code-block language="html" label="Interactive canvas with crosshair cursor">{interactiveCanvasCode}</code-block>

    <h3>.drawing</h3>
    <p>Crosshair cursor with <code>touch-action: none</code> for drawing applications that handle touch events manually.</p>
    <div class="example">
      <canvas class="bordered drawing" width="300" height="150" style="background: var(--color-surface-raised);"></canvas>
      <p><small>Click and drag to draw</small></p>
    </div>
    <code-block language="html" label="Drawing canvas with touch handling">{drawingCanvasCode}</code-block>

    <h3>.full</h3>
    <p>Full container width.</p>
    <div class="example">
      <canvas class="bordered full" width="800" height="200" style="background: var(--color-surface-raised);"></canvas>
    </div>

    <h3>.fixed</h3>
    <p>Full width with fixed height (400px).</p>
    <div class="example" style="max-block-size: 250px; overflow: hidden;">
      <canvas class="bordered fixed" width="800" height="400" style="background: var(--color-surface-raised);"></canvas>
    </div>
  </section>

  <section>
    <h2>Responsive Canvas</h2>
    <p>Use the <code>.canvas-responsive</code> wrapper to maintain aspect ratio while filling available width.</p>

    <div class="example" style="max-inline-size: 500px;">
      <div class="canvas-responsive" style="background: var(--color-surface-raised);">
        <canvas></canvas>
      </div>
    </div>
    <code-block language="html" label="Responsive canvas wrapper">{responsiveCanvasCode}</code-block>

    <p>The wrapper maintains a 16:9 aspect ratio by default. The canvas is positioned absolutely to fill the container.</p>

    <h3>Custom Aspect Ratios</h3>
    <code-block language="html" label="Custom aspect ratio canvases">{customAspectCode}</code-block>
  </section>

  <section>
    <h2>Canvas Sizing</h2>
    <p>Canvas has two size concepts: the element size (CSS) and the drawing buffer size (attributes).</p>
    <code-block language="html" label="Canvas with separate buffer and display sizes">{sizingCode}</code-block>

    <h3>High DPI / Retina Support</h3>
    <code-block language="javascript" label="Retina display scaling for canvas">{retinaCode}</code-block>
  </section>

  <section>
    <h2>Live Examples</h2>

    <h3>Basic Drawing</h3>
    <div class="example">
      <canvas class="bordered" width="400" height="200" style="background: var(--color-surface-raised);"></canvas>
    </div>
    <code-block language="javascript" label="Basic canvas drawing example">{basicDrawingCode}</code-block>

    <h3>Chart Placeholder</h3>
    <div class="example">
      <figure>
        <canvas class="bordered" width="500" height="250" style="background: var(--color-surface-raised);"></canvas>
        <figcaption>Monthly sales data - Q4 2025</figcaption>
      </figure>
    </div>
  </section>

  <section>
    <h2>Accessibility</h2>
    <p>Canvas content is not accessible to screen readers by default. You must provide alternatives.</p>

    <h3>Fallback Content</h3>
    <p>Place fallback content inside the canvas element for browsers that don't support canvas or for screen readers.</p>
    <code-block language="html" label="Canvas with accessible fallback content">{fallbackCode}</code-block>

    <h3>ARIA Labels</h3>
    <code-block language="html" label="Canvas with ARIA label">{ariaLabelCode}</code-block>

    <h3>Data Tables</h3>
    <p>For complex data visualizations, provide an accessible data table nearby.</p>
    <code-block language="html" label="Canvas chart with linked data table">{dataTableCode}</code-block>

    <h3>Best Practices</h3>
    <ul>
      <li>Always provide text alternatives for informative canvas content</li>
      <li>Use <code>role="img"</code> and <code>aria-label</code> for simple graphics</li>
      <li>Provide data tables for charts and graphs</li>
      <li>Ensure interactive canvases are keyboard accessible</li>
      <li>Respect <code>prefers-reduced-motion</code> for animated content</li>
    </ul>
  </section>

  <section>
    <h2>Related Elements</h2>
    <ul>
      <li><a href="/docs/elements/native/svg/"><code>&lt;svg&gt;</code></a> - Scalable vector graphics, often better for accessibility</li>
      <li><a href="/docs/elements/native/img/"><code>&lt;img&gt;</code></a> - Static images</li>
      <li><a href="/docs/elements/native/figure/"><code>&lt;figure&gt;</code></a> - Wrap canvas with captions</li>
    </ul>
  </section>

  <section>
    <h2>CSS Reference</h2>
    <p>Styles defined in <code>/src/native-elements/canvas/styles.css</code></p>

    <table class="props-table">
      <thead>
        <tr>
          <th>Selector</th>
          <th>Properties</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>canvas</code></td>
          <td><code>display: block; max-inline-size: 100%;</code></td>
        </tr>
        <tr>
          <td><code>canvas.full</code></td>
          <td><code>inline-size: 100%; block-size: auto;</code></td>
        </tr>
        <tr>
          <td><code>canvas.fixed</code></td>
          <td><code>inline-size: 100%; block-size: 400px;</code></td>
        </tr>
        <tr>
          <td><code>canvas.interactive</code></td>
          <td><code>cursor: crosshair;</code></td>
        </tr>
        <tr>
          <td><code>canvas.drawing</code></td>
          <td><code>cursor: crosshair; touch-action: none;</code></td>
        </tr>
        <tr>
          <td><code>canvas.bordered</code></td>
          <td><code>border; border-radius;</code></td>
        </tr>
        <tr>
          <td><code>canvas.loading</code></td>
          <td><code>background with diagonal stripes;</code></td>
        </tr>
        <tr>
          <td><code>.canvas-responsive</code></td>
          <td><code>position: relative; aspect-ratio: 16 / 9;</code></td>
        </tr>
      </tbody>
    </table>
  </section>
</ElementLayout>
