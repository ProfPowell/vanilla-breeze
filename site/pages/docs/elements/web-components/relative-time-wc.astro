---
/**
 * relative-time-wc Web Component Documentation
 *
 * Auto-refreshing relative time display using Intl.RelativeTimeFormat.
 */
import ElementLayout from '../../../../layouts/ElementLayout.astro';

// Generate dynamic datetimes for demos
const now = new Date();
const fiveMinAgo = new Date(now.getTime() - 5 * 60 * 1000).toISOString();
const twoHoursAgo = new Date(now.getTime() - 2 * 60 * 60 * 1000).toISOString();
const yesterday = new Date(now.getTime() - 24 * 60 * 60 * 1000).toISOString();
const lastWeek = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString();
const inOneHour = new Date(now.getTime() + 60 * 60 * 1000).toISOString();

const basicCode = `<relative-time-wc>
  <time datetime="2026-02-09T10:00:00Z">February 9, 2026</time>
</relative-time-wc>`;

const inlineCode = `<p>Last updated:
  <relative-time-wc>
    <time datetime="2026-02-09T08:30:00Z">February 9, 2026 at 8:30 AM</time>
  </relative-time-wc>
</p>`;

const futureCode = `<p>Event starts
  <relative-time-wc>
    <time datetime="2026-02-10T14:00:00Z">February 10, 2026 at 2:00 PM</time>
  </relative-time-wc>
</p>`;

const activityCode = `<ul>
  <li>
    Alice commented
    <relative-time-wc>
      <time datetime="...">5 minutes ago</time>
    </relative-time-wc>
  </li>
  <li>
    Bob pushed a commit
    <relative-time-wc>
      <time datetime="...">2 hours ago</time>
    </relative-time-wc>
  </li>
</ul>`;
---

<ElementLayout
  title="relative-time-wc"
  description="Auto-refreshing relative time display using Intl.RelativeTimeFormat."
  elementName="relative-time-wc"
  category="component"
  currentPath="/docs/elements/web-components/relative-time-wc/"
>
  <section>
    <h2>Overview</h2>
    <p>The <code>&lt;relative-time-wc&gt;</code> component finds a child <code>&lt;time&gt;</code> element, reads its <code>datetime</code> attribute, and replaces the text with a human-readable relative string like "3 hours ago" or "in 2 days". The original text is preserved as a <code>title</code> attribute for hover access.</p>

    <browser-window
      src="/docs/examples/demos/relative-time-basic.html"
      url="https://vanilla-breeze.dev/relative-time"
      title="Relative Time"
      shadow>
    </browser-window>

    <code-block language="html" show-lines label="Basic usage">{basicCode}</code-block>
  </section>

  <section>
    <h2>How It Works</h2>
    <ol>
      <li>Finds the child <code>&lt;time&gt;</code> element and reads its <code>datetime</code> attribute</li>
      <li>Stores the original text content as a <code>title</code> attribute (visible on hover)</li>
      <li>Replaces the text with a relative time string using <code>Intl.RelativeTimeFormat</code></li>
      <li>Auto-refreshes on an adaptive interval: every 60s for recent times, every 5 min for &lt;24h, every hour for older</li>
    </ol>
    <p>The component uses the user's locale for formatting, so times display in their preferred language automatically.</p>
  </section>

  <section>
    <h2>Progressive Enhancement</h2>
    <p>The <code>&lt;time&gt;</code> element's original text serves as a fallback when JavaScript is unavailable. Users always see a readable date, with relative formatting layered on top.</p>

    <code-block language="html" show-lines label="Fallback text visible without JS">{basicCode}</code-block>
  </section>

  <section>
    <h2>Live Examples</h2>
    <p>These examples use dynamic datetimes relative to when this page was loaded. Hover over each to see the original date in the tooltip.</p>

    <div class="example">
      <layout-stack data-gap="s">
        <p>5 minutes ago: <relative-time-wc><time datetime={fiveMinAgo}>Loading...</time></relative-time-wc></p>
        <p>2 hours ago: <relative-time-wc><time datetime={twoHoursAgo}>Loading...</time></relative-time-wc></p>
        <p>Yesterday: <relative-time-wc><time datetime={yesterday}>Loading...</time></relative-time-wc></p>
        <p>Last week: <relative-time-wc><time datetime={lastWeek}>Loading...</time></relative-time-wc></p>
        <p>In 1 hour: <relative-time-wc><time datetime={inOneHour}>Loading...</time></relative-time-wc></p>
      </layout-stack>
    </div>
  </section>

  <section>
    <h2>Inline Usage</h2>
    <p>The component works naturally inline with text.</p>

    <div class="example">
      <p>Last updated: <relative-time-wc><time datetime={twoHoursAgo}>a few hours ago</time></relative-time-wc></p>
    </div>

    <code-block language="html" show-lines label="Inline with paragraph text">{inlineCode}</code-block>
  </section>

  <section>
    <h2>Future Dates</h2>
    <p>The component handles future dates too, displaying strings like "in 3 hours" or "in 2 days".</p>

    <div class="example">
      <p>Event starts <relative-time-wc><time datetime={inOneHour}>soon</time></relative-time-wc></p>
    </div>

    <code-block language="html" show-lines label="Future date display">{futureCode}</code-block>
  </section>

  <section>
    <h2>Auto-Refresh</h2>
    <p>The display updates automatically on an adaptive schedule:</p>

    <table class="props-table">
      <thead>
        <tr>
          <th>Age of timestamp</th>
          <th>Refresh interval</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>&lt; 1 hour</td>
          <td>Every 60 seconds</td>
        </tr>
        <tr>
          <td>&lt; 24 hours</td>
          <td>Every 5 minutes</td>
        </tr>
        <tr>
          <td>&gt; 24 hours</td>
          <td>Every hour</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>Common Use Cases</h2>

    <h3>Activity Feeds</h3>
    <p>Show when events happened in a list:</p>

    <div class="example">
      <layout-stack data-gap="s">
        <p>Alice commented <relative-time-wc><time datetime={fiveMinAgo}>just now</time></relative-time-wc></p>
        <p>Bob pushed a commit <relative-time-wc><time datetime={twoHoursAgo}>earlier today</time></relative-time-wc></p>
        <p>Carol opened an issue <relative-time-wc><time datetime={lastWeek}>last week</time></relative-time-wc></p>
      </layout-stack>
    </div>

    <code-block language="html" show-lines label="Activity feed timestamps">{activityCode}</code-block>

    <h3>Content Metadata</h3>
    <p>Display article or post timestamps:</p>

    <div class="example">
      <article>
        <h3 style="margin: 0;">Getting Started with Vanilla Breeze</h3>
        <p style="color: var(--color-text-muted); margin-block-start: var(--size-xs);">
          Published <relative-time-wc><time datetime={yesterday}>yesterday</time></relative-time-wc>
        </p>
      </article>
    </div>
  </section>

  <section>
    <h2>Accessibility</h2>
    <ul>
      <li>The original human-readable date is preserved as a <code>title</code> attribute, accessible on hover</li>
      <li>The <code>cursor: help</code> style hints that additional information is available</li>
      <li>The semantic <code>&lt;time&gt;</code> element with <code>datetime</code> attribute provides machine-readable dates for assistive technology</li>
      <li>Falls back to the original text content when JavaScript is unavailable</li>
    </ul>
  </section>
</ElementLayout>
