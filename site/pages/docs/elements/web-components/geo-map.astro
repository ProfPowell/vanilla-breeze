---
/**
 * geo-map Web Component Documentation
 *
 * Static map tiles with marker pin and address caption.
 */
import ElementLayout from '../../../../layouts/ElementLayout.astro';

const basicCode = `<geo-map lat="40.7484" lng="-73.9857" zoom="15">
  <address>
    <strong>Empire State Building</strong><br/>
    20 W 34th St, New York, NY 10001
  </address>
</geo-map>`;

const providerCode = `<!-- OpenStreetMap (default) -->
<geo-map lat="51.5007" lng="-0.1246" zoom="15" provider="osm"></geo-map>

<!-- Carto Light — minimal, clean style -->
<geo-map lat="51.5007" lng="-0.1246" zoom="15" provider="carto-light"></geo-map>

<!-- Carto Dark — great for dark themes -->
<geo-map lat="51.5007" lng="-0.1246" zoom="15" provider="carto-dark"></geo-map>`;

const markerCode = `<!-- Default marker -->
<geo-map lat="40.7484" lng="-73.9857" zoom="15"></geo-map>

<!-- Custom color -->
<geo-map lat="40.7484" lng="-73.9857" zoom="15" marker-color="#2563eb"></geo-map>

<!-- No marker -->
<geo-map lat="40.7484" lng="-73.9857" zoom="15" marker="false"></geo-map>`;

const captionCode = `<!-- Slotted address as caption -->
<geo-map lat="48.8584" lng="2.2945" zoom="16">
  <address>
    <strong>Eiffel Tower</strong><br/>
    Champ de Mars, 5 Av. Anatole France<br/>
    75007 Paris, France
  </address>
</geo-map>

<!-- No caption — just the map -->
<geo-map lat="48.8584" lng="2.2945" zoom="16"></geo-map>`;

const fallbackCode = `<!-- Before JS loads, the address is visible and clickable -->
<geo-map lat="40.7484" lng="-73.9857" zoom="15">
  <address>
    <a href="https://www.openstreetmap.org/?mlat=40.7484&mlon=-73.9857#map=15/40.7484/-73.9857">
      Empire State Building<br/>
      20 W 34th St, New York, NY 10001
    </a>
  </address>
</geo-map>`;

const stylingCode = `/* Custom height */
geo-map {
  --geo-map-height: 400px;
}

/* Custom border radius */
geo-map {
  --geo-map-border-radius: 1rem;
}

/* Custom marker */
geo-map {
  --geo-map-marker-color: #2563eb;
  --geo-map-marker-size: 40px;
}

/* Custom caption */
geo-map {
  --geo-map-caption-bg: rgba(0, 0, 0, 0.7);
  --geo-map-caption-padding: 0.75rem 1rem;
}`;

const eventsCode = `const map = document.querySelector('geo-map');

map.addEventListener('geo-map:ready', (e) => {
  console.log('Tiles loaded:', e.detail);
  // { lat: 40.7484, lng: -73.9857, zoom: 15 }
});

map.addEventListener('geo-map:error', (e) => {
  console.error('Map error:', e.detail.message);
});`;

const contactCode = `<section>
  <layout-sidebar data-layout-gap="xl" data-layout-sidebar-width="wide">
    <!-- Contact Form -->
    <form action="/contact" method="POST" data-layout="stack" data-layout-gap="l">
      <h2>Send a message</h2>
      <form-field>
        <label for="name">Name</label>
        <input type="text" id="name" name="name" required/>
      </form-field>
      <form-field>
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required/>
      </form-field>
      <form-field>
        <label for="message">Message</label>
        <textarea id="message" name="message" rows="4" required></textarea>
      </form-field>
      <button type="submit">Send message</button>
    </form>

    <!-- Map Sidebar -->
    <aside>
      <geo-map lat="37.7749" lng="-122.4194" zoom="14"
               style="--geo-map-height: 100%; min-height: 300px;">
        <address>
          123 Business Ave<br/>
          San Francisco, CA 94102
        </address>
      </geo-map>
    </aside>
  </layout-sidebar>
</section>`;
---

<ElementLayout
  title="geo-map"
  description="A zero-dependency map component using OpenStreetMap tiles. Renders a static tile grid centered on given coordinates with an optional marker pin and address caption."
  elementName="<geo-map>"
  category="component"
  currentPath="/docs/elements/web-components/geo-map/"
>
  <section>
    <h2>Overview</h2>
    <layout-text>
      <p>The <code>&lt;geo-map&gt;</code> component displays a static map using free OpenStreetMap tiles. It calculates tile coordinates from <code>lat</code>/<code>lng</code> attributes and renders a 3&times;3 tile grid clipped to the component dimensions.</p>
      <p><strong>Key features:</strong></p>
      <ul>
        <li>Zero dependencies &mdash; no API keys, no external libraries</li>
        <li>Free tiles from OpenStreetMap or Carto</li>
        <li>Progressive enhancement &mdash; slotted <code>&lt;address&gt;</code> visible before JS</li>
        <li>SVG marker pin with customizable color</li>
        <li>CSS custom properties for styling</li>
        <li>Shadow DOM with exposed CSS parts</li>
      </ul>
    </layout-text>

    <div class="example">
      <geo-map lat="40.7484" lng="-73.9857" zoom="15">
        <address>
          <strong>Empire State Building</strong><br/>
          20 W 34th St, New York, NY 10001
        </address>
      </geo-map>
    </div>

    <code-block language="html" show-lines label="Basic usage">{basicCode}</code-block>
  </section>

  <section>
    <h2>Attributes</h2>

    <table class="props-table">
      <thead>
        <tr>
          <th>Attribute</th>
          <th>Type</th>
          <th>Default</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>lat</code></td>
          <td>Number</td>
          <td>&mdash;</td>
          <td>Latitude of map center</td>
        </tr>
        <tr>
          <td><code>lng</code></td>
          <td>Number</td>
          <td>&mdash;</td>
          <td>Longitude of map center</td>
        </tr>
        <tr>
          <td><code>zoom</code></td>
          <td>Number</td>
          <td><code>15</code></td>
          <td>Tile zoom level (1&ndash;19)</td>
        </tr>
        <tr>
          <td><code>marker</code></td>
          <td>Boolean</td>
          <td><code>true</code></td>
          <td>Show pin at center. Set to <code>"false"</code> to hide.</td>
        </tr>
        <tr>
          <td><code>marker-color</code></td>
          <td>String</td>
          <td><code>#e74c3c</code></td>
          <td>Pin fill color</td>
        </tr>
        <tr>
          <td><code>provider</code></td>
          <td>String</td>
          <td><code>osm</code></td>
          <td>Tile source: <code>osm</code>, <code>carto-light</code>, <code>carto-dark</code></td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>Tile Providers</h2>
    <layout-text>
      <p>Three free tile providers are supported. All require attribution (included automatically).</p>
    </layout-text>

    <div class="example">
      <layout-stack data-layout-gap="m">
        <div>
          <strong>OSM (default)</strong>
          <geo-map lat="51.5007" lng="-0.1246" zoom="15" provider="osm" style="--geo-map-height: 200px;"></geo-map>
        </div>
        <div>
          <strong>Carto Light</strong>
          <geo-map lat="51.5007" lng="-0.1246" zoom="15" provider="carto-light" style="--geo-map-height: 200px;"></geo-map>
        </div>
        <div>
          <strong>Carto Dark</strong>
          <geo-map lat="51.5007" lng="-0.1246" zoom="15" provider="carto-dark" style="--geo-map-height: 200px;"></geo-map>
        </div>
      </layout-stack>
    </div>

    <code-block language="html" show-lines label="Provider variants">{providerCode}</code-block>
  </section>

  <section>
    <h2>Marker</h2>
    <layout-text>
      <p>The marker pin is an inline SVG positioned at the center of the map. Customize its color with the <code>marker-color</code> attribute or hide it with <code>marker="false"</code>.</p>
    </layout-text>

    <div class="example">
      <layout-stack data-layout-gap="m">
        <geo-map lat="40.7484" lng="-73.9857" zoom="15" style="--geo-map-height: 180px;"></geo-map>
        <geo-map lat="40.7484" lng="-73.9857" zoom="15" marker-color="#2563eb" style="--geo-map-height: 180px;"></geo-map>
        <geo-map lat="40.7484" lng="-73.9857" zoom="15" marker="false" style="--geo-map-height: 180px;"></geo-map>
      </layout-stack>
    </div>

    <code-block language="html" show-lines label="Marker variants">{markerCode}</code-block>
  </section>

  <section>
    <h2>Caption</h2>
    <layout-text>
      <p>Slot an <code>&lt;address&gt;</code> (or any content) as a caption overlay at the bottom of the map. This content is also the no-JS fallback.</p>
    </layout-text>

    <code-block language="html" show-lines label="Caption slot">{captionCode}</code-block>
  </section>

  <section>
    <h2>No-JS Fallback</h2>
    <layout-text>
      <p>Before the component upgrades, the slotted content is visible as a styled card. Include a link to OpenStreetMap so users can still find the location.</p>
    </layout-text>

    <code-block language="html" show-lines label="Progressive enhancement">{fallbackCode}</code-block>
  </section>

  <section>
    <h2>CSS Custom Properties</h2>

    <table class="props-table">
      <thead>
        <tr>
          <th>Property</th>
          <th>Default</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>--geo-map-height</code></td>
          <td><code>300px</code></td>
          <td>Component height</td>
        </tr>
        <tr>
          <td><code>--geo-map-border-radius</code></td>
          <td><code>0.5rem</code></td>
          <td>Border radius</td>
        </tr>
        <tr>
          <td><code>--geo-map-marker-color</code></td>
          <td><code>#e74c3c</code></td>
          <td>Marker pin fill (overridden by <code>marker-color</code> attr)</td>
        </tr>
        <tr>
          <td><code>--geo-map-marker-size</code></td>
          <td><code>32px</code></td>
          <td>Marker pin dimensions</td>
        </tr>
        <tr>
          <td><code>--geo-map-caption-bg</code></td>
          <td><code>rgba(255,255,255,0.9)</code></td>
          <td>Caption background</td>
        </tr>
        <tr>
          <td><code>--geo-map-caption-padding</code></td>
          <td><code>0.5rem 0.75rem</code></td>
          <td>Caption padding</td>
        </tr>
        <tr>
          <td><code>--geo-map-attribution-font-size</code></td>
          <td><code>0.625rem</code></td>
          <td>Attribution text size</td>
        </tr>
      </tbody>
    </table>

    <code-block language="css" show-lines label="Styling with custom properties">{stylingCode}</code-block>
  </section>

  <section>
    <h2>CSS Parts</h2>

    <table class="props-table">
      <thead>
        <tr>
          <th>Part</th>
          <th>Element</th>
          <th>Purpose</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>container</code></td>
          <td>Outer wrapper</td>
          <td>Overall sizing and border radius</td>
        </tr>
        <tr>
          <td><code>tiles</code></td>
          <td>Tile grid area</td>
          <td>Map image area</td>
        </tr>
        <tr>
          <td><code>marker</code></td>
          <td>SVG pin</td>
          <td>Marker styling</td>
        </tr>
        <tr>
          <td><code>caption</code></td>
          <td>Slot wrapper</td>
          <td>Address/label display</td>
        </tr>
        <tr>
          <td><code>attribution</code></td>
          <td>OSM credit</td>
          <td>Required attribution link</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>Events</h2>

    <table class="props-table">
      <thead>
        <tr>
          <th>Event</th>
          <th>Detail</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>geo-map:ready</code></td>
          <td><code>{'{ lat, lng, zoom }'}</code></td>
          <td>Fired after tiles finish loading</td>
        </tr>
        <tr>
          <td><code>geo-map:error</code></td>
          <td><code>{'{ message }'}</code></td>
          <td>Fired on tile load failure or missing coordinates</td>
        </tr>
      </tbody>
    </table>

    <code-block language="javascript" show-lines label="Listening to events">{eventsCode}</code-block>
  </section>

  <section>
    <h2>Contact Page Example</h2>
    <layout-text>
      <p>A common use case: pair <code>&lt;geo-map&gt;</code> with a contact form in a sidebar layout.</p>
    </layout-text>

    <code-block language="html" show-lines label="Contact form with map">{contactCode}</code-block>
  </section>

  <section>
    <h2>Accessibility</h2>
    <layout-text>
      <ul>
        <li>Tile grid has <code>role="img"</code> with an <code>aria-label</code> describing the coordinates</li>
        <li>Marker SVG is <code>aria-hidden="true"</code> (decorative)</li>
        <li>Attribution link opens in a new tab with <code>rel="noopener"</code></li>
        <li>Slotted <code>&lt;address&gt;</code> content is accessible before and after JS loads</li>
      </ul>
    </layout-text>
  </section>

  <section>
    <h2>Related Elements</h2>
    <ul>
      <li><a href="/docs/elements/web-components/icons/"><code>&lt;icon-wc&gt;</code></a> &mdash; Icon component (similar Shadow DOM pattern)</li>
      <li><a href="/docs/patterns/forms/contact/">Contact patterns</a> &mdash; Contact form layouts with map integration</li>
    </ul>
  </section>
</ElementLayout>
