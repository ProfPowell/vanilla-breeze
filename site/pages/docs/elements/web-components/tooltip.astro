---
/**
 * tooltip-wc Web Component Documentation
 *
 * Positioned tooltips with keyboard support, directional arrows,
 * and configurable delay.
 */
import ElementLayout from '../../../../layouts/ElementLayout.astro';

// Code examples as template strings
const basicUsageCode = `<tooltip-wc data-content="This is a tooltip!">
  <button type="button">Hover me</button>
</tooltip-wc>`;

const positionCode = `<tooltip-wc data-position="top">
  <button>Top</button>
  <template data-tooltip>Tooltip appears above</template>
</tooltip-wc>

<tooltip-wc data-position="bottom">
  <button>Bottom</button>
  <template data-tooltip>Tooltip appears below</template>
</tooltip-wc>

<tooltip-wc data-position="left">
  <button>Left</button>
  <template data-tooltip>Tooltip on the left</template>
</tooltip-wc>

<tooltip-wc data-position="right">
  <button>Right</button>
  <template data-tooltip>Tooltip on the right</template>
</tooltip-wc>`;

const richContentCode = `<tooltip-wc>
  <button type="button">Save</button>
  <template data-tooltip>
    <strong>Save document</strong><br>
    <kbd>Ctrl</kbd> + <kbd>S</kbd>
  </template>
</tooltip-wc>`;

const secondaryInfoCode = `<tooltip-wc>
  <button>Copy</button>
  <template data-tooltip>
    Copy to clipboard<br>
    <small>Copied items expire after 24 hours</small>
  </template>
</tooltip-wc>`;

const elementTypesCode = `<!-- On a link -->
<tooltip-wc>
  <a href="#">Hover this link</a>
  <template data-tooltip>Links can have tooltips!</template>
</tooltip-wc>

<!-- On an icon button -->
<tooltip-wc data-position="bottom">
  <button type="button" class="ghost" aria-label="Settings">
    <icon-wc name="settings"></icon-wc>
  </button>
  <template data-tooltip>Open settings</template>
</tooltip-wc>

<!-- On text with tabindex -->
<tooltip-wc>
  <span tabindex="0">What's this?</span>
  <template data-tooltip>Additional information</template>
</tooltip-wc>`;

const delayCode = `<tooltip-wc data-delay="0">
  <button>Instant</button>
  <template data-tooltip>Shows immediately</template>
</tooltip-wc>

<tooltip-wc data-delay="500">
  <button>Delayed</button>
  <template data-tooltip>Waits 500ms</template>
</tooltip-wc>`;

const eventCode = `const tooltip = document.querySelector('tooltip-wc');

tooltip.addEventListener('tooltip-show', () => {
  console.log('Tooltip shown');
});

tooltip.addEventListener('tooltip-hide', () => {
  console.log('Tooltip hidden');
});`;

const apiCode = `const tooltip = document.querySelector('tooltip-wc');

// Show the tooltip
tooltip.show();

// Check visibility
console.log(tooltip.isVisible); // true

// Hide the tooltip
tooltip.hide();`;

const iconButtonCode = `<tooltip-wc>
  <button type="button" class="ghost" aria-label="Edit">
    <icon-wc name="edit"></icon-wc>
  </button>
  <template data-tooltip>Edit item</template>
</tooltip-wc>`;

const formHelpCode = `<layout-cluster data-gap="xs" data-align="center">
  <label for="password-field">Password</label>
  <tooltip-wc data-position="right">
    <button type="button" class="ghost" aria-label="Password requirements">
      <icon-wc name="help-circle" size="sm"></icon-wc>
    </button>
    <template data-tooltip>Must be at least 8 characters</template>
  </tooltip-wc>
</layout-cluster>`;

const cardVariantCode = `<tooltip-wc data-variant="card">
  <a href="/user/jane" data-trigger>Jane Smith</a>
  <div data-content>
    <div style="display: flex; align-items: center; gap: var(--size-s);">
      <img src="/avatars/jane.jpg" alt="" />
      <div>
        <strong>Jane Smith</strong>
        <p class="text-muted" style="margin: 0;">Senior Developer at Acme Co</p>
      </div>
    </div>
    <p class="text-muted" style="margin-block: var(--size-xs) 0;">
      Joined March 2023 &middot; 142 contributions
    </p>
  </div>
</tooltip-wc>`;

const truncatedCode = `<tooltip-wc>
  <span tabindex="0" class="truncate">
    This is a very long text that gets truncated
  </span>
  <template data-tooltip>This is a very long text that gets truncated</template>
</tooltip-wc>`;
---

<ElementLayout
  title="tooltip-wc"
  description="Positioned tooltips with keyboard support, directional arrows, and configurable delay."
  elementName="tooltip-wc"
  category="component"
  currentPath="/docs/elements/web-components/tooltip/"
>
  <section>
    <h2>Overview</h2>
    <p>The <code>&lt;tooltip-wc&gt;</code> component wraps a trigger element and displays a tooltip on hover or focus. Tooltips are positioned automatically and include an arrow pointing to the trigger.</p>

    <browser-window
      src="/docs/examples/demos/tooltip-basic.html"
      url="https://vanilla-breeze.dev/tooltip"
      title="Tooltip"
      shadow>
    </browser-window>

    <code-block language="html" show-lines label="Simple tooltip with data-content">{basicUsageCode}</code-block>
  </section>

  <section>
    <h2>How It Works</h2>
    <p>The <code>&lt;tooltip-wc&gt;</code> component uses modern web platform features for optimal performance:</p>

    <h3>Popover API</h3>
    <p>Tooltips use the native <a href="https://developer.mozilla.org/en-US/docs/Web/API/Popover_API">Popover API</a> with <code>popover="hint"</code>. This renders tooltips in the browser's top layer, avoiding z-index conflicts and overflow clipping issues.</p>

    <h3>CSS Anchor Positioning</h3>
    <p>In modern browsers (Chrome 125+, Safari 18+), tooltips use <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_anchor_positioning">CSS Anchor Positioning</a> for smooth, hardware-accelerated positioning. This eliminates JavaScript positioning calculations in supported browsers.</p>

    <p>For older browsers, the component automatically falls back to JavaScript-based positioning.</p>

    <h3>Browser Support</h3>
    <table class="props-table">
      <thead>
        <tr>
          <th>Browser</th>
          <th>Positioning</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Chrome 125+</td>
          <td>CSS Anchor</td>
          <td>Full support</td>
        </tr>
        <tr>
          <td>Safari 18+</td>
          <td>CSS Anchor</td>
          <td>Full support</td>
        </tr>
        <tr>
          <td>Firefox</td>
          <td>JS Fallback</td>
          <td>Anchor positioning not yet supported</td>
        </tr>
        <tr>
          <td>Older browsers</td>
          <td>JS Fallback</td>
          <td>Requires Popover API support</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>Attributes</h2>
    <table class="props-table">
      <thead>
        <tr>
          <th>Attribute</th>
          <th>Type</th>
          <th>Default</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>data-content</code></td>
          <td>string</td>
          <td>-</td>
          <td>Simple text tooltip content. For rich HTML content, use <code>&lt;template data-tooltip&gt;</code> instead.</td>
        </tr>
        <tr>
          <td><code>data-position</code></td>
          <td>string</td>
          <td><code>"top"</code></td>
          <td>Tooltip position: <code>top</code>, <code>bottom</code>, <code>left</code>, or <code>right</code>.</td>
        </tr>
        <tr>
          <td><code>data-delay</code></td>
          <td>number</td>
          <td><code>200</code></td>
          <td>Show delay in milliseconds.</td>
        </tr>
        <tr>
          <td><code>data-variant</code></td>
          <td>string</td>
          <td>-</td>
          <td>Set to <code>"card"</code> for hover card mode with rich content, card styling, and longer delay (300ms).</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>Positions</h2>
    <p>Use <code>data-position</code> to control where the tooltip appears relative to the trigger.</p>

    <div class="example">
      <layout-cluster data-gap="xl" style="padding: var(--size-xl);">
        <tooltip-wc data-position="top">
          <button type="button" class="secondary">Top</button>
          <template data-tooltip>Tooltip appears above</template>
        </tooltip-wc>

        <tooltip-wc data-position="bottom">
          <button type="button" class="secondary">Bottom</button>
          <template data-tooltip>Tooltip appears below</template>
        </tooltip-wc>

        <tooltip-wc data-position="left">
          <button type="button" class="secondary">Left</button>
          <template data-tooltip>Tooltip appears on the left</template>
        </tooltip-wc>

        <tooltip-wc data-position="right">
          <button type="button" class="secondary">Right</button>
          <template data-tooltip>Tooltip appears on the right</template>
        </tooltip-wc>
      </layout-cluster>
    </div>

    <code-block language="html" show-lines label="Tooltip position variants">{positionCode}</code-block>
  </section>

  <section>
    <h2>Rich Content</h2>
    <p>For tooltips with formatted content-keyboard shortcuts, icons, multiple lines, or emphasis-use the <code>&lt;template data-tooltip&gt;</code> approach instead of <code>data-content</code>.</p>

    <div class="example">
      <layout-cluster data-gap="l">
        <tooltip-wc>
          <button type="button">
            <icon-wc name="save" size="sm"></icon-wc>
            Save
          </button>
          <template data-tooltip>
            <strong>Save document</strong><br>
            <kbd>Ctrl</kbd> + <kbd>S</kbd>
          </template>
        </tooltip-wc>

        <tooltip-wc>
          <button type="button" class="secondary">Copy</button>
          <template data-tooltip>
            Copy to clipboard<br>
            <small>Copied items expire after 24 hours</small>
          </template>
        </tooltip-wc>

        <tooltip-wc data-position="bottom">
          <button type="button" class="ghost" aria-label="Status">
            <icon-wc name="circle" size="sm" style="color: var(--color-success);"></icon-wc>
          </button>
          <template data-tooltip>
            <icon-wc name="check" size="sm"></icon-wc>
            <strong>Connected</strong><br>
            Last sync: 2 minutes ago
          </template>
        </tooltip-wc>
      </layout-cluster>
    </div>

    <code-block language="html" show-lines label="Rich tooltip with keyboard shortcut">{richContentCode}</code-block>

    <code-block language="html" show-lines label="Tooltip with secondary info">{secondaryInfoCode}</code-block>
  </section>

  <section>
    <h2>With Different Elements</h2>
    <p>Tooltips can be attached to any focusable element, including links and icon buttons.</p>

    <div class="example">
      <layout-cluster data-gap="l">
        <tooltip-wc>
          <a href="#">Hover this link</a>
          <template data-tooltip>Links can have tooltips too!</template>
        </tooltip-wc>

        <tooltip-wc data-position="bottom">
          <button type="button" class="ghost" aria-label="Settings">
            <icon-wc name="settings"></icon-wc>
          </button>
          <template data-tooltip>Open settings</template>
        </tooltip-wc>

        <tooltip-wc data-position="bottom">
          <button type="button" class="ghost" aria-label="Help">?</button>
          <template data-tooltip>Click for help</template>
        </tooltip-wc>

        <tooltip-wc>
          <span tabindex="0" style="text-decoration: underline dotted; cursor: help;">What's this?</span>
          <template data-tooltip>Additional information about this feature</template>
        </tooltip-wc>
      </layout-cluster>
    </div>

    <code-block language="html" show-lines label="Tooltips on different element types">{elementTypesCode}</code-block>
  </section>

  <section>
    <h2>Long Content</h2>
    <p>Tooltips can contain longer text that wraps automatically. The tooltip stays within viewport boundaries.</p>

    <div class="example">
      <layout-cluster data-gap="l">
        <tooltip-wc data-position="bottom">
          <button type="button">Hover for details</button>
          <template data-tooltip>This is a longer tooltip that demonstrates how the component handles multi-line content. The tooltip will wrap text and stay within viewport boundaries.</template>
        </tooltip-wc>

        <tooltip-wc data-position="top">
          <button type="button" class="secondary">More info</button>
          <template data-tooltip>Tooltips automatically adjust their position to remain visible, even when near the edge of the screen.</template>
        </tooltip-wc>
      </layout-cluster>
    </div>
  </section>

  <section>
    <h2>Card Variant</h2>
    <p>For richer content previews like user profiles or link previews, use <code>data-variant="card"</code>. This mode uses a card-style popover instead of a compact tooltip.</p>

    <div class="example">
      <div>Hover over
        <tooltip-wc data-variant="card">
          <a href="#" data-trigger>this link</a>
          <div data-content>
            <p><strong>Rich Content</strong></p>
            <p class="text-muted">This hover card shows structured content on hover. It has a surface background, border, and shadow.</p>
          </div>
        </tooltip-wc>
        to see the card.
      </div>
    </div>

    <code-block language="html" show-lines label="Card variant with profile content">{cardVariantCode}</code-block>

    <h3>Differences from Regular Tooltip</h3>
    <table class="props-table">
      <thead>
        <tr>
          <th>Feature</th>
          <th>Tooltip (default)</th>
          <th>Card variant</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Content model</td>
          <td><code>data-content</code> or <code>&lt;template data-tooltip&gt;</code></td>
          <td><code>[data-trigger]</code> + <code>[data-content]</code></td>
        </tr>
        <tr>
          <td>Appearance</td>
          <td>Dark, compact, with arrow</td>
          <td>Light card surface, border, shadow, no arrow</td>
        </tr>
        <tr>
          <td>Show delay</td>
          <td>200ms</td>
          <td>300ms</td>
        </tr>
        <tr>
          <td>Hide delay</td>
          <td>100ms</td>
          <td>200ms</td>
        </tr>
        <tr>
          <td>Popover type</td>
          <td><code>hint</code></td>
          <td><code>manual</code> (supports interactive content)</td>
        </tr>
        <tr>
          <td>ARIA</td>
          <td><code>role="tooltip"</code>, <code>aria-describedby</code></td>
          <td>None (supplementary content)</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>Show Delay</h2>
    <p>Use <code>data-delay</code> to control how long to wait before showing the tooltip. Default is 200ms.</p>

    <div class="example">
      <layout-cluster data-gap="l">
        <tooltip-wc data-delay="0">
          <button type="button" class="secondary">No delay (0ms)</button>
          <template data-tooltip>Shows immediately</template>
        </tooltip-wc>

        <tooltip-wc data-delay="200">
          <button type="button" class="secondary">Normal delay (200ms)</button>
          <template data-tooltip>Default timing</template>
        </tooltip-wc>

        <tooltip-wc data-delay="500">
          <button type="button" class="secondary">Long delay (500ms)</button>
          <template data-tooltip>Waits half a second</template>
        </tooltip-wc>
      </layout-cluster>
    </div>

    <code-block language="html" show-lines label="Configuring show delay">{delayCode}</code-block>
  </section>

  <section>
    <h2>Events</h2>
    <p>The component dispatches events when the tooltip is shown or hidden.</p>

    <table class="props-table">
      <thead>
        <tr>
          <th>Event</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>tooltip-show</code></td>
          <td>Fired when the tooltip becomes visible.</td>
        </tr>
        <tr>
          <td><code>tooltip-hide</code></td>
          <td>Fired when the tooltip is hidden.</td>
        </tr>
      </tbody>
    </table>

    <code-block language="javascript" show-lines label="Listening for tooltip events">{eventCode}</code-block>
  </section>

  <section>
    <h2>JavaScript API</h2>
    <p>The component exposes methods for programmatic control.</p>

    <table class="props-table">
      <thead>
        <tr>
          <th>Method/Property</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>show()</code></td>
          <td>method</td>
          <td>Show the tooltip immediately.</td>
        </tr>
        <tr>
          <td><code>hide()</code></td>
          <td>method</td>
          <td>Hide the tooltip immediately.</td>
        </tr>
        <tr>
          <td><code>isVisible</code></td>
          <td>property</td>
          <td>Read-only boolean indicating if the tooltip is currently visible.</td>
        </tr>
      </tbody>
    </table>

    <code-block language="javascript" show-lines label="Programmatic tooltip control">{apiCode}</code-block>
  </section>

  <section>
    <h2>Keyboard Support</h2>
    <p>Tooltips appear on keyboard focus and can be dismissed with the Escape key. Escape handling is built into the Popover API-no custom JavaScript required.</p>

    <table class="props-table">
      <thead>
        <tr>
          <th>Key</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><kbd>Tab</kbd></td>
          <td>Focus the trigger element, showing the tooltip</td>
        </tr>
        <tr>
          <td><kbd>Escape</kbd></td>
          <td>Hide the tooltip while keeping focus on the trigger</td>
        </tr>
      </tbody>
    </table>

    <div class="example">
      <p>Use Tab to focus the button below, then press Escape to hide the tooltip:</p>
      <tooltip-wc>
        <button type="button">Focus me with Tab</button>
        <template data-tooltip>Press Escape to dismiss this tooltip</template>
      </tooltip-wc>
    </div>
  </section>

  <section>
    <h2>Accessibility</h2>

    <h3>ARIA Attributes</h3>
    <ul>
      <li>The tooltip has <code>role="tooltip"</code> and <code>popover="hint"</code></li>
      <li>The trigger element has <code>aria-describedby</code> pointing to the tooltip</li>
      <li>The tooltip arrow has <code>aria-hidden="true"</code></li>
      <li>Uses the browser's top layer for proper stacking without z-index conflicts</li>
    </ul>

    <h3>Screen Reader Behavior</h3>
    <p>When the trigger receives focus, screen readers announce the element followed by the tooltip content (via <code>aria-describedby</code>). This provides context without requiring visual interaction.</p>

    <h3>Best Practices</h3>
    <ul>
      <li>Keep tooltip content brief and informative</li>
      <li>Don't put essential information only in tooltips</li>
      <li>Ensure the trigger element is focusable</li>
      <li>Use tooltips for supplementary information, not primary content</li>
      <li>Avoid interactive content inside tooltips</li>
    </ul>
  </section>

  <section>
    <h2>Viewport Awareness</h2>
    <p>Tooltips automatically adjust their position to stay within the viewport. The JavaScript fallback (for browsers without CSS Anchor support) clamps tooltip positions to keep them visible.</p>

    <div class="example">
      <layout-cluster data-gap="l" data-justify="between">
        <tooltip-wc data-position="left">
          <button type="button" class="secondary">Near left edge</button>
          <template data-tooltip>This tooltip adjusts to stay visible</template>
        </tooltip-wc>

        <tooltip-wc data-position="right">
          <button type="button" class="secondary">Near right edge</button>
          <template data-tooltip>This tooltip also adjusts automatically</template>
        </tooltip-wc>
      </layout-cluster>
    </div>
  </section>

  <section>
    <h2>Common Use Cases</h2>

    <h3>Icon Button Labels</h3>
    <p>Provide context for icon-only buttons:</p>
    <div class="example">
      <layout-cluster data-gap="s">
        <tooltip-wc>
          <button type="button" class="ghost" aria-label="Edit">
            <icon-wc name="edit"></icon-wc>
          </button>
          <template data-tooltip>Edit item</template>
        </tooltip-wc>
        <tooltip-wc>
          <button type="button" class="ghost" aria-label="Delete">
            <icon-wc name="trash"></icon-wc>
          </button>
          <template data-tooltip>Delete item</template>
        </tooltip-wc>
        <tooltip-wc>
          <button type="button" class="ghost" aria-label="Share">
            <icon-wc name="share"></icon-wc>
          </button>
          <template data-tooltip>Share item</template>
        </tooltip-wc>
      </layout-cluster>
    </div>

    <code-block language="html" show-lines label="Icon button with tooltip">{iconButtonCode}</code-block>

    <h3>Form Field Help</h3>
    <p>Add help text for form fields:</p>
    <div class="example">
      <layout-stack data-gap="xs" style="max-inline-size: 20rem;">
        <layout-cluster data-gap="xs" data-align="center">
          <label for="password-field">Password</label>
          <tooltip-wc data-position="right">
            <button type="button" class="ghost small" aria-label="Password requirements" style="padding: 0;">
              <icon-wc name="help-circle" size="sm"></icon-wc>
            </button>
            <template data-tooltip>Must be at least 8 characters with one number and one special character</template>
          </tooltip-wc>
        </layout-cluster>
        <input type="password" id="password-field" placeholder="Enter password" />
      </layout-stack>
    </div>

    <code-block language="html" show-lines label="Form field help tooltip">{formHelpCode}</code-block>

    <h3>Truncated Text</h3>
    <p>Show full text for truncated content:</p>
    <div class="example">
      <tooltip-wc>
        <span tabindex="0" style="display: block; max-inline-size: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
          This is a very long text that gets truncated
        </span>
        <template data-tooltip>This is a very long text that gets truncated</template>
      </tooltip-wc>
    </div>

    <code-block language="html" show-lines label="Truncated text with tooltip">{truncatedCode}</code-block>
  </section>
</ElementLayout>
