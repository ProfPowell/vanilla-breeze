---
/**
 * ElementLayout
 *
 * Layout for individual element documentation pages.
 * Includes sidebar navigation and table of contents.
 */

import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import navigation from '../data/navigation.json';

// Docs-specific styles (BaseHead imports main.css)
import '../../docs/docs.css';

interface Props {
  title: string;
  description: string;
  elementName: string;
  category: 'native' | 'custom' | 'component';
  currentPath?: string;
  nativeGroup?: string; // Which native group to open (e.g., 'Text Semantics')
}

const { title, description, elementName, category, currentPath, nativeGroup } = Astro.props;

// Get elements navigation from JSON
const elements = navigation.elements;

const categoryMeta = {
  native:    { label: elements.native.label,    href: '/docs/elements/native/' },
  custom:    { label: elements.custom.label,     href: '/docs/elements/custom-elements/' },
  component: { label: elements.component.label,  href: '/docs/elements/web-components/' },
};
const crumb = categoryMeta[category];
---

<!DOCTYPE html>
<html lang="en" data-page="docs">
<head>
  <BaseHead title={title} description={description} />
</head>
<body>
  <Header currentSection="api" />

  <main data-pagefind-body>
    <input type="checkbox" id="nav-drawer-toggle" class="nav-drawer-checkbox"/>
    <label for="nav-drawer-toggle" class="nav-drawer-toggle">
      <icon-wc name="list-tree" size="sm"></icon-wc>
      Navigation
    </label>
    <label for="nav-drawer-toggle" class="nav-drawer-backdrop"></label>

    <layout-sidebar data-layout-gap="xl" data-layout-sidebar-width="narrow" data-layout-content-min="60">
      <nav class="tree" id="nav-drawer" data-layout-density="compact" aria-label="Elements navigation" data-vt="sidebar">
        <label for="nav-drawer-toggle" class="nav-drawer-close" aria-label="Close navigation">
          <icon-wc name="x"></icon-wc>
        </label>

        <!-- Native Elements -->
        <details open={category === 'native'}>
          <summary>{elements.native.label}</summary>
          {elements.native.groups.map(group => (
            <details open={nativeGroup === group.label}>
              <summary>{group.label}</summary>
              <ul>
                {group.items.map(item => (
                  <li>
                    <a href={item.href} aria-current={currentPath === item.href ? 'page' : undefined}>
                      {item.name}
                    </a>
                  </li>
                ))}
              </ul>
            </details>
          ))}
        </details>

        <!-- Custom Elements -->
        <details open={category === 'custom'}>
          <summary>{elements.custom.label}</summary>
          <ul>
            {elements.custom.items.map(item => (
              <li>
                <a href={item.href} aria-current={currentPath === item.href ? 'page' : undefined}>
                  {item.name}
                </a>
              </li>
            ))}
          </ul>
        </details>

        <!-- Web Components -->
        <details open={category === 'component'}>
          <summary>{elements.component.label}</summary>
          <ul>
            {elements.component.items.map(item => (
              <li>
                <a href={item.href} aria-current={currentPath === item.href ? 'page' : undefined}>
                  {item.name}
                </a>
              </li>
            ))}
          </ul>
        </details>
      </nav>

      <layout-sidebar data-layout-side="end" data-layout-sidebar-width="narrow" data-layout-gap="xl">
        <aside>
          <page-toc data-levels="h2,h3" data-scope="article"></page-toc>
        </aside>
        <article>
          <nav class="breadcrumb" aria-label="Breadcrumb">
            <ol>
              <li><a href="/docs/elements/">Elements</a></li>
              <li><a href={crumb.href}>{crumb.label}</a></li>
              <li><span aria-current="page">{elementName}</span></li>
            </ol>
          </nav>
          <h1>{elementName}</h1>
          <p class="lead">{description}</p>

          <heading-links data-levels="h2,h3">
            <slot />
          </heading-links>
        </article>
      </layout-sidebar>
    </layout-sidebar>
  </main>

  <Footer />
  <shortcuts-wc></shortcuts-wc>

  <script>
    // Vanilla Breeze core
    import '/src/lib/theme-manager.js';
    import '/src/custom-elements/register.js';
    import '/src/utils/tooltip-init.js';
    import '/src/lib/debug-content-model.js';
    import { ThemeManager } from '/src/lib/theme-manager.js';
    import { initExternalThemeSync } from '/src/utils/external-theme-sync.js';

    // Web components - explicit imports for bundling
    import '/src/web-components/tabs-wc/logic.js';
    import '/src/web-components/footnotes-wc/logic.js';
    import '/src/web-components/accordion-wc/logic.js';
    import '/src/web-components/toast-wc/logic.js';
    import '/src/web-components/tooltip-wc/logic.js';
    import '/src/web-components/dropdown-wc/logic.js';
    import '/src/web-components/icon-wc/icon-wc.js';
    import '/src/web-components/theme-wc/logic.js';
    import '/src/web-components/heading-links/logic.js';
    import '/src/web-components/page-toc/logic.js';
    import '/src/web-components/table-wc/logic.js';
    import '/src/web-components/search-wc/logic.js';
    import '/src/web-components/card-list/logic.js';
    import '/src/web-components/flip-card-wc/logic.js';
    import '/src/web-components/comparison-wc/logic.js';
    import '/src/web-components/splitter-wc/logic.js';
    import '/src/web-components/carousel-wc/logic.js';
    import '/src/web-components/rating-wc/logic.js';
    import '/src/web-components/combobox-wc/logic.js';
    import '/src/web-components/tags-wc/logic.js';
    import '/src/web-components/context-menu-wc/logic.js';
    import '/src/web-components/command-wc/logic.js';
    import '/src/web-components/shortcuts-wc/logic.js';
    import '/src/utils/interest-polyfill.js';
    import '/src/utils/copy-init.js';
    import '/src/utils/hotkey-init.js';
    import '/src/utils/command-init.js';
    import '/src/utils/format-number-init.js';
    import '/src/utils/format-date-init.js';
    import '/src/utils/format-bytes-init.js';
    import '/src/utils/ticker-init.js';
    import '/src/utils/spoiler-init.js';
    import '/src/utils/splitter-init.js';
    import '/src/utils/rating-init.js';
    import '/src/utils/switch-init.js';
    import '/src/utils/textarea-count-init.js';
    import '/src/utils/textarea-grow-init.js';
    import '/src/utils/conditional-init.js';
    import '/src/utils/range-init.js';
    import '/src/utils/upload-init.js';
    import '/src/utils/autosave-init.js';
    import '/src/utils/mask-init.js';
    import '/src/utils/toggle-tags-init.js';
    import '/src/utils/number-init.js';
    import '/src/utils/color-init.js';
    import '/src/utils/glitch-init.js';
    import '/src/utils/reveal-init.js';
    import '/src/utils/blur-reveal-init.js';
    import '/src/utils/highlight-init.js';
    import '/src/utils/typewriter-init.js';
    import '/src/utils/scramble-init.js';
    import '/src/utils/view-transition-init.js';
    import '/src/utils/select-all-init.js';
    import '/src/utils/animate-image-init.js';
    import '/src/web-components/qr-code-wc/logic.js';
    import '/src/web-components/html-include-wc/logic.js';
    import '/src/web-components/slide-accept-wc/logic.js';
    import '/src/web-components/geo-map/logic.js';

    import '@profpowell/code-block';
    import '@profpowell/browser-window';

    ThemeManager.init();
    initExternalThemeSync();
  </script>
</body>
</html>
