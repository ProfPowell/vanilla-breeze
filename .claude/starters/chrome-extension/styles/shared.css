/**
 * Shared Extension Styles
 * Common styles for popup and options pages
 */

@layer reset, tokens, base, components;

/* Reset Layer */
@layer reset {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
}

/* Design Tokens Layer */
@layer tokens {
  :root {
    color-scheme: light dark;

    /* Colors - OKLCH */
    --primary: oklch(42% 0.17 265);
    --primary-hover: oklch(38% 0.17 265);
    --success: oklch(55% 0.16 145);
    --success-bg: oklch(95% 0.05 145);
    --error: oklch(55% 0.22 27);
    --error-bg: oklch(95% 0.05 27);
    --warning: oklch(65% 0.15 75);
    --warning-bg: oklch(95% 0.05 75);

    /* Gray Scale - OKLCH */
    --gray-50: oklch(98% 0.005 265);
    --gray-100: oklch(96% 0.005 265);
    --gray-200: oklch(92% 0.005 265);
    --gray-300: oklch(86% 0.005 265);
    --gray-400: oklch(70% 0.01 265);
    --gray-500: oklch(55% 0.01 265);
    --gray-600: oklch(45% 0.01 265);
    --gray-700: oklch(35% 0.015 265);
    --gray-800: oklch(25% 0.015 265);
    --gray-900: oklch(18% 0.015 265);

    /* Semantic Colors - using light-dark() */
    --text: light-dark(var(--gray-900), var(--gray-50));
    --text-muted: light-dark(var(--gray-500), var(--gray-400));
    --background: light-dark(var(--gray-50), var(--gray-900));
    --surface: light-dark(oklch(100% 0 0), var(--gray-800));
    --border: light-dark(var(--gray-200), var(--gray-700));

    /* Spacing */
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-6: 1.5rem;
    --space-8: 2rem;

    /* Typography */
    --font-sans: system-ui, -apple-system, sans-serif;
    --text-xs: 0.75rem;
    --text-sm: 0.875rem;
    --text-base: 1rem;
    --text-lg: 1.125rem;
    --text-2xl: 1.5rem;
    --font-medium: 500;
    --font-semibold: 600;
    --font-bold: 700;

    /* Effects */
    --radius-sm: 0.25rem;
    --radius-md: 0.375rem;
    --radius-lg: 0.5rem;
  }
}

/* Base Element Styles Layer */
@layer base {
  html {
    font-family: var(--font-sans);
    font-size: var(--text-base);
    line-height: 1.5;
    color: var(--text);
    background: var(--background);
  }

  body {
    min-inline-size: 300px;
  }

  a {
    color: var(--primary);
    text-decoration: none;

    &:hover {
      text-decoration: underline;
    }
  }

  :focus-visible {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
  }

  button {
    font-family: inherit;
  }

  input,
  select,
  textarea {
    font-family: inherit;
    font-size: inherit;
  }
}

/* Shared Components Layer */
@layer components {
  /* Toggle Switch Component */
  input[type="checkbox"][data-toggle] {
    inline-size: 2.5rem;
    block-size: 1.25rem;
    appearance: none;
    background: var(--gray-300);
    border-radius: 9999px;
    position: relative;
    cursor: pointer;
    transition: background-color 0.2s;

    &::before {
      content: '';
      position: absolute;
      inset-block-start: 2px;
      inset-inline-start: 2px;
      inline-size: 1rem;
      block-size: 1rem;
      background: oklch(100% 0 0);
      border-radius: 50%;
      transition: transform 0.2s;
    }

    &:checked {
      background: var(--primary);

      &::before {
        transform: translateX(1.25rem);
      }
    }

    &:focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }
  }

  /* Form Field Custom Element */
  form-field {
    display: block;
    margin-block-end: var(--space-4);

    &:last-child {
      margin-block-end: 0;
    }

    & label {
      display: block;
      font-size: var(--text-sm);
      font-weight: var(--font-medium);
      margin-block-end: var(--space-1);
    }

    & input:not([data-toggle]),
    & textarea,
    & select {
      inline-size: 100%;
      padding: var(--space-2) var(--space-3);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      font-size: var(--text-base);
      background: var(--surface);
      color: var(--text);

      &:focus {
        outline: 2px solid var(--primary);
        outline-offset: 2px;
      }
    }

    & output {
      display: block;
      font-size: var(--text-sm);
      color: var(--text-muted);
      margin-block-start: var(--space-1);
    }

    /* Toggle row layout */
    &[data-layout="row"] {
      display: flex;
      justify-content: space-between;
      align-items: center;

      & label {
        margin-block-end: 0;
      }
    }
  }

  /* Button Variants */
  buttonbutton, a.button {
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius-md);
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    cursor: pointer;
    background: var(--primary);
    color: oklch(100% 0 0);
    border: none;

    &:hover {
      background: var(--primary-hover);
    }

    &:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
  }

  button[data-variant="link"] {
    background: none;
    border: none;
    color: var(--primary);
    font-size: var(--text-sm);
    cursor: pointer;
    padding: 0;

    &:hover {
      text-decoration: underline;
    }
  }

  /* Status Display */
  [data-role="status"] {
    padding: var(--space-2) var(--space-3);
    background: var(--gray-100);
    border-radius: var(--radius-md);
    font-size: var(--text-sm);
    text-align: center;
    transition: background-color 0.3s, color 0.3s;

    &[data-state="updated"] {
      background: var(--success-bg);
      color: var(--success);
    }

    &[data-state="success"] {
      color: var(--success);
    }

    &[data-state="error"] {
      color: var(--error);
    }
  }
}
