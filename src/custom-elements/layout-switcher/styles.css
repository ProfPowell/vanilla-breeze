/* layout-switcher: Flexbox that switches direction at a threshold */

layout-switcher {
  display: flex;
  flex-wrap: wrap;
  gap: var(--_gap, var(--size-m));
}

layout-switcher > * {
  flex-grow: 1;
  flex-basis: calc((var(--_threshold, 30rem) - 100%) * 999);
}

/* Gap variants */
layout-switcher[data-layout-gap="none"] { --_gap: 0; }
layout-switcher[data-layout-gap="xs"] { --_gap: var(--size-xs); }
layout-switcher[data-layout-gap="s"] { --_gap: var(--size-s); }
layout-switcher[data-layout-gap="m"] { --_gap: var(--size-m); }
layout-switcher[data-layout-gap="l"] { --_gap: var(--size-l); }
layout-switcher[data-layout-gap="xl"] { --_gap: var(--size-xl); }

/* Threshold variants - point at which layout switches */
layout-switcher[data-layout-threshold="20rem"] { --_threshold: 20rem; }
layout-switcher[data-layout-threshold="25rem"] { --_threshold: 25rem; }
layout-switcher[data-layout-threshold="30rem"] { --_threshold: 30rem; }
layout-switcher[data-layout-threshold="35rem"] { --_threshold: 35rem; }
layout-switcher[data-layout-threshold="40rem"] { --_threshold: 40rem; }
layout-switcher[data-layout-threshold="45rem"] { --_threshold: 45rem; }

/* Limit number of items before forcing vertical */
layout-switcher[data-layout-limit="2"] > :nth-last-child(n+3),
layout-switcher[data-layout-limit="2"] > :nth-last-child(n+3) ~ * {
  flex-basis: 100%;
}

layout-switcher[data-layout-limit="3"] > :nth-last-child(n+4),
layout-switcher[data-layout-limit="3"] > :nth-last-child(n+4) ~ * {
  flex-basis: 100%;
}

layout-switcher[data-layout-limit="4"] > :nth-last-child(n+5),
layout-switcher[data-layout-limit="4"] > :nth-last-child(n+5) ~ * {
  flex-basis: 100%;
}

/* Reverse order when stacked */
layout-switcher[data-layout-reverse] {
  flex-direction: row-reverse;
}

layout-switcher[data-layout-reverse][data-layout-threshold] {
  flex-wrap: wrap-reverse;
}
