/* anchor: Link styling with variants and auto-detection */

a {
  color: var(--color-interactive);
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 0.15em;
  transition:
    color var(--duration-fast) var(--ease-default),
    text-decoration-thickness var(--duration-fast) var(--ease-default);

  &:hover {
    text-decoration-thickness: 2px;
  }

  &:focus-visible {
    outline: var(--border-width-medium) solid var(--color-interactive);
    outline-offset: var(--border-width-thin);
    border-radius: var(--radius-s);
  }

  /* Remove underline for links wrapping block elements */
  &:has(> img),
  &:has(> picture),
  &:has(> figure),
  &:has(> layout-card) {
    text-decoration: none;
  }
}

/* ===========================================
   Link Variants (data-variant API)
   =========================================== */

/* Muted link - less prominent, for secondary navigation */
a[data-variant="muted"] {
  color: var(--color-text-muted);

  &:hover {
    color: var(--color-text);
  }
}

/* Plain link - no underline by default, appears on hover */
a[data-variant="plain"] {
  text-decoration: none;

  &:hover {
    text-decoration: underline;
  }
}

/* Legacy class support (backwards compatibility) */
a.muted {
  color: var(--color-text-muted);

  &:hover {
    color: var(--color-text);
  }
}

a.plain {
  text-decoration: none;

  &:hover {
    text-decoration: underline;
  }
}

/* ===========================================
   Auto-Detect Link Types
   Use data-no-icon to suppress auto-icons
   =========================================== */

/* External links - auto-detect http(s) links */
a[href^="http"]:where(:not([data-no-icon]))::after,
a[href^="//"]:where(:not([data-no-icon]))::after {
  content: "↗";
  font-size: 0.9em;
  font-style: normal;
  opacity: 0.7;
  display: inline-block;
  text-decoration: none;
  padding-inline-start: 0.5em;
}

/* Legacy .external class support */
a.external::after {
  content: "↗";
  font-size: 0.9em;
  font-style: normal;
  opacity: 0.7;
  display: inline-block;
  text-decoration: none;
  padding-inline-start: 0.5em;
}

/* Download links */
a[download]:where(:not([data-no-icon]))::after {
  content: "↓";
  font-size: 0.9em;
  font-style: normal;
  opacity: 0.7;
  display: inline-block;
  text-decoration: none;
  padding-inline-start: 0.5em;
}

/* ===========================================
   Manual Link Icons
   Use <icon-wc> inside links for custom icons
   =========================================== */

/* Icon inside link - removes underline, adds spacing */
a > icon-wc,
a > x-icon {
  text-decoration: none;
  margin-inline-end: 0.35em;
  vertical-align: -0.125em; /* Optical alignment */
}

/* Icon after link text (trailing) */
a > icon-wc:last-child,
a > x-icon:last-child {
  margin-inline-end: 0;
  margin-inline-start: 0.35em;
}

/* ===========================================
   Context Overrides
   Links in navigation contexts don't show icons
   =========================================== */

nav a[href^="http"]::after,
nav a[href^="//"]::after,
nav a[download]::after,
header a[href^="http"]::after,
header a[href^="//"]::after,
footer a[href^="http"]::after,
footer a[href^="//"]::after,
footer a[download]::after {
  content: none;
}

/* Icon-only links — no external indicator or trailing margin */
a:has(> icon-wc:only-child)::after,
a:has(> x-icon:only-child)::after,
a:has(> svg:only-child)::after,
a:has(> img:only-child)::after {
  content: none;
}

a > icon-wc:only-child,
a > x-icon:only-child {
  margin-inline: 0;
}

/* ===========================================
   Button-Styled Links
   Use class="button" on <a> for CTA links
   =========================================== */

/* Button-styled link - overrides anchor defaults */
a.button {
  text-decoration: none;
  color: white;

  &:hover {
    text-decoration: none;
  }

  /* Suppress auto-icons on button-styled links */
  &[href^="http"]::after,
  &[href^="//"]::after,
  &[download]::after {
    content: none;
  }
}

a.button.secondary {
  color: var(--color-interactive);
}

a.button.ghost {
  color: var(--color-text);
}
