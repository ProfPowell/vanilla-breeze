/* i18n: Script-specific typography, ruby visibility, locale quotes, translate, dir */

/* ============================================================
   1. SCRIPT-SPECIFIC TYPOGRAPHY
   Uses :lang() so rules inherit through the subtree.
   ============================================================ */

/* CJK: Chinese, Japanese, Korean */
:lang(zh),
:lang(ja),
:lang(ko) {
  font-family: var(--font-cjk);
  line-height: 1.8;
  letter-spacing: 0;
  word-break: break-all;
  overflow-wrap: normal;
}

/* Japanese: proportional alternates for punctuation */
:lang(ja) {
  font-feature-settings: "palt" 1;
}

/* Arabic script: Arabic, Persian, Urdu, Pashto */
:lang(ar),
:lang(fa),
:lang(ur),
:lang(ps) {
  font-family: var(--font-arabic);
  line-height: 1.9;
  letter-spacing: normal;
  word-spacing: 0.05em;
  text-align: start;
}

/* Hebrew */
:lang(he),
:lang(yi) {
  font-family: var(--font-hebrew);
  line-height: 1.75;
  letter-spacing: normal;
}

/* Thai: no word breaks, needs larger line height */
:lang(th) {
  font-family: var(--font-thai);
  line-height: 2;
  word-break: normal;
  overflow-wrap: break-word;
}

/* Devanagari: Hindi, Marathi, Sanskrit, Nepali */
:lang(hi),
:lang(mr),
:lang(sa),
:lang(ne) {
  font-family: var(--font-devanagari);
  line-height: 1.75;
}

/* ============================================================
   2. RUBY ANNOTATION VISIBILITY
   Controlled by data-ruby on <html>:
     show — always visible
     hide — hidden from view, kept in DOM (accessible + copyable)
     auto — show only for CJK languages (default behavior)
   ============================================================ */

/* Ruby text inherits script font for CJK */
:lang(ja) rt, :lang(zh) rt, :lang(ko) rt {
  font-family: var(--font-cjk);
}

/* show: always display rt */
:root[data-ruby="show"] rt {
  display: block;
}

/* hide: visually hidden, accessible */
:root[data-ruby="hide"] rt {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* auto: start hidden */
:root[data-ruby="auto"] rt {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* auto: re-show for CJK languages */
:root[data-ruby="auto"]:lang(ja) rt,
:root[data-ruby="auto"]:lang(zh) rt,
:root[data-ruby="auto"]:lang(ko) rt,
:root[data-ruby="auto"] :lang(ja) rt,
:root[data-ruby="auto"] :lang(zh) rt,
:root[data-ruby="auto"] :lang(ko) rt {
  position: static;
  width: auto;
  height: auto;
  padding: initial;
  margin: initial;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* ============================================================
   3. LOCALE-AWARE QUOTATION MARKS
   CSS quotes property adapts to language convention.
   ============================================================ */

q { quotes: "\201C" "\201D" "\2018" "\2019"; }          /* English "..." */
:lang(de) q { quotes: "\201E" "\201C" "\201A" "\2018"; } /* German  „..." */
:lang(fr) q { quotes: "\00AB" "\00BB" "\2039" "\203A"; } /* French  «...» */
:lang(ja) q { quotes: "\300C" "\300D" "\300E" "\300F"; } /* Japanese「...」*/
:lang(zh) q { quotes: "\300C" "\300D" "\300E" "\300F"; } /* Chinese 「...」*/
:lang(ru) q { quotes: "\00AB" "\00BB" "\201E" "\201C"; } /* Russian «...» */

q::before { content: open-quote; }
q::after  { content: close-quote; }

/* ============================================================
   4. UNTRANSLATABLE CONTENT
   Elements that should not be modified by browser/machine
   translation tools.
   ============================================================ */

code,
kbd,
samp,
pre,
var {
  translate: no;
}

/* ============================================================
   5. READING DIRECTION UTILITIES
   Supplement logical properties where direction context matters.
   ============================================================ */

[dir="rtl"] {
  unicode-bidi: embed;
}

[dir="auto"] {
  unicode-bidi: isolate;
}

/* ============================================================
   6. NUMERIC FORMATTING HINTS
   Browser-level number rendering via font features.
   ============================================================ */

[data-numeric="tabular"] {
  font-variant-numeric: tabular-nums;
}

[data-numeric="proportional"] {
  font-variant-numeric: proportional-nums;
}
