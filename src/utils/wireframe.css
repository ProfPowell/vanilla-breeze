/* Wireframe mode: Sketch-like aesthetic for rapid HTML prototyping */
/* Activated by <html data-wireframe> or on any container element */
/*
 * Fidelity levels:
 * - data-wireframe="lo"  : Scribble font, rough borders, pure B&W
 * - data-wireframe="mid" : Block font, dashed borders, grayscale
 * - data-wireframe="hi"  : System fonts, subtle styling, near-production
 * - data-wireframe       : Default/legacy behavior (same as mid)
 * - data-wireframe="annotate" : Show element labels
 */

/* Root variables for wireframe styling - Light mode (default) */
[data-wireframe] {
  --wireframe-stroke: oklch(30% 0 0);
  --wireframe-fill: oklch(98% 0 0);
  --wireframe-text: oklch(15% 0 0);
  --wireframe-muted: oklch(50% 0 0);
  --wireframe-accent: oklch(90% 0 0);
  --wireframe-border: 2px dashed var(--wireframe-stroke);
  --wireframe-label-bg: var(--wireframe-stroke);
  --wireframe-label-color: var(--wireframe-fill);
}

/* Dark mode support via data-mode attribute */
[data-mode="dark"] [data-wireframe],
html[data-wireframe][data-mode="dark"] {
  --wireframe-stroke: oklch(80% 0 0);
  --wireframe-fill: oklch(12% 0 0);
  --wireframe-text: oklch(92% 0 0);
  --wireframe-muted: oklch(65% 0 0);
  --wireframe-accent: oklch(20% 0 0);
}

/* Dark mode support via system preference (auto mode) */
@media (prefers-color-scheme: dark) {
  html[data-wireframe]:not([data-mode="light"]),
  [data-wireframe]:not([data-mode="light"]) {
    --wireframe-stroke: oklch(80% 0 0);
    --wireframe-fill: oklch(12% 0 0);
    --wireframe-text: oklch(92% 0 0);
    --wireframe-muted: oklch(65% 0 0);
    --wireframe-accent: oklch(20% 0 0);
  }
}

/* Wireframe mode indicator */
html[data-wireframe]::before {
  content: "WIREFRAME";
  position: fixed;
  inset-block-end: var(--size-s);
  inset-inline-end: var(--size-s);
  z-index: 99999;
  padding: var(--size-2xs) var(--size-s);
  background: var(--wireframe-stroke);
  color: var(--wireframe-fill);
  font-size: var(--font-size-xs);
  font-weight: 600;
  font-family: system-ui, sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  border-radius: var(--radius-s);
  pointer-events: none;
}

/* Apply grayscale to everything in wireframe mode */
html[data-wireframe] {
  filter: grayscale(1);
}

/* Remove all shadows and decorative effects */
[data-wireframe] * {
  box-shadow: none !important;
  text-shadow: none !important;
}

/* --- Borders: Convert to dashed sketch lines --- */
[data-wireframe] :is(
  article, aside, section, main, nav, header, footer,
  div, form, fieldset,
  layout-card, layout-sidebar, layout-stack, layout-grid, layout-center, layout-cluster, layout-cover, layout-switcher, layout-reel
) {
  border: var(--wireframe-border) !important;
  border-radius: 0 !important;
  background: var(--wireframe-fill) !important;
}

/* Headings: Simple underlines */
[data-wireframe] :is(h1, h2, h3, h4, h5, h6) {
  border-block-end: var(--wireframe-border);
  padding-block-end: var(--size-2xs);
  background: transparent !important;
}

/* Links: Dotted underline only */
[data-wireframe] a {
  color: var(--wireframe-text) !important;
  text-decoration: underline dotted var(--wireframe-stroke) !important;
  background: transparent !important;
}

/* Buttons: Simple outlined boxes */
[data-wireframe] button,
[data-wireframe] [role="button"],
[data-wireframe] input[type="submit"],
[data-wireframe] input[type="button"],
[data-wireframe] .button {
  border: var(--wireframe-border) !important;
  border-radius: 0 !important;
  background: var(--wireframe-fill) !important;
  color: var(--wireframe-text) !important;
}

/* Form inputs: Simple outlined fields */
[data-wireframe] :is(input, textarea, select) {
  border: var(--wireframe-border) !important;
  border-radius: 0 !important;
  background: var(--wireframe-fill) !important;
  color: var(--wireframe-text) !important;
}

/* --- Images: Placeholder boxes with X --- */
[data-wireframe] img,
[data-wireframe] picture,
[data-wireframe] video,
[data-wireframe] iframe,
[data-wireframe] canvas {
  position: relative;
  background: var(--wireframe-fill) !important;
  border: var(--wireframe-border) !important;
  object-fit: none !important;
}

/* Hide actual image content */
[data-wireframe] img {
  color: transparent;
}

/* Add X pattern overlay to images using gradient */
[data-wireframe] picture,
[data-wireframe] figure:has(img) {
  position: relative;
}

[data-wireframe] img::after,
[data-wireframe] picture::after,
[data-wireframe] video::after {
  content: "";
  position: absolute;
  inset: 0;
  background:
    linear-gradient(
      to bottom right,
      transparent calc(50% - 1px),
      var(--wireframe-stroke) calc(50% - 1px),
      var(--wireframe-stroke) calc(50% + 1px),
      transparent calc(50% + 1px)
    ),
    linear-gradient(
      to top right,
      transparent calc(50% - 1px),
      var(--wireframe-stroke) calc(50% - 1px),
      var(--wireframe-stroke) calc(50% + 1px),
      transparent calc(50% + 1px)
    );
  pointer-events: none;
}

/* Tables: Simple grid lines */
[data-wireframe] table {
  border-collapse: collapse;
  border: var(--wireframe-border) !important;
}

[data-wireframe] :is(th, td) {
  border: 1px dashed var(--wireframe-stroke) !important;
  background: var(--wireframe-fill) !important;
}

[data-wireframe] th {
  background: var(--wireframe-accent) !important;
}

/* Cards and interactive elements */
[data-wireframe] :is(details, dialog) {
  border: var(--wireframe-border) !important;
  border-radius: 0 !important;
  background: var(--wireframe-fill) !important;
}

[data-wireframe] summary {
  border-block-end: 1px dashed var(--wireframe-stroke) !important;
}

/* Lists: Simple markers */
[data-wireframe] :is(ul, ol) {
  list-style: square !important;
}

[data-wireframe] ul {
  list-style: "- " !important;
}

/* Blockquotes: Left border only */
[data-wireframe] blockquote {
  border: none !important;
  border-inline-start: 4px solid var(--wireframe-stroke) !important;
  background: transparent !important;
}

/* Code blocks: Simple box */
[data-wireframe] :is(pre, code) {
  border: 1px dashed var(--wireframe-stroke) !important;
  border-radius: 0 !important;
  background: var(--wireframe-accent) !important;
  color: var(--wireframe-text) !important;
}

/* Horizontal rules: Simple dashed line */
[data-wireframe] hr {
  border: none !important;
  border-block-start: var(--wireframe-border) !important;
  background: transparent !important;
}

/* --- Annotations: Label elements with their tag name --- */
/* Optional: Add data-wireframe="annotate" for element labels */
[data-wireframe="annotate"] *:not(script):not(style):not(br):not(hr)::before {
  content: "<" attr(data-label, "") ">";
  position: absolute;
  inset-block-start: -1.2em;
  inset-inline-start: 0;
  font-size: 10px;
  font-family: monospace;
  color: var(--wireframe-muted);
  pointer-events: none;
}

/* Label common elements automatically when annotating */
[data-wireframe="annotate"] header::before { content: "<header>"; }
[data-wireframe="annotate"] nav::before { content: "<nav>"; }
[data-wireframe="annotate"] main::before { content: "<main>"; }
[data-wireframe="annotate"] aside::before { content: "<aside>"; }
[data-wireframe="annotate"] footer::before { content: "<footer>"; }
[data-wireframe="annotate"] article::before { content: "<article>"; }
[data-wireframe="annotate"] section::before { content: "<section>"; }

/* --- Scoped wireframe mode --- */
/* Apply wireframe only to a specific container */
:not(html)[data-wireframe] {
  /* Don't apply grayscale filter to containers, only html */
  filter: none;
}

/* Container-scoped mode indicator */
:not(html)[data-wireframe]::before {
  content: "wireframe";
  display: block;
  padding: var(--size-3xs) var(--size-2xs);
  margin-block-end: var(--size-xs);
  background: var(--wireframe-stroke);
  color: var(--wireframe-fill);
  font-size: var(--font-size-xs);
  font-family: monospace;
  width: fit-content;
}

/* --- Reduced motion support --- */
/* Wireframe mode is mostly static, but ensure no transitions */
@media (prefers-reduced-motion: reduce) {
  [data-wireframe] * {
    transition: none !important;
    animation: none !important;
  }
}

/* ============================================== */
/* FIDELITY LEVELS                                */
/* ============================================== */

/* --- Lo-fi: Maximum abstraction, sketch aesthetic --- */
/* Pure B&W for maximum contrast in both light and dark modes */
[data-wireframe="lo"] {
  --wireframe-stroke: oklch(0% 0 0);
  --wireframe-fill: oklch(100% 0 0);
  --wireframe-text: oklch(0% 0 0);
  --wireframe-muted: oklch(40% 0 0);
  --wireframe-accent: oklch(95% 0 0);
  --wireframe-border: 2px solid var(--wireframe-stroke);
  --font-sans: var(--wf-font-scribble, 'Redacted Script', cursive);
  --font-serif: var(--wf-font-scribble, 'Redacted Script', cursive);
  --font-mono: var(--wf-font-scribble, 'Redacted Script', cursive);
}

/* Lo-fi dark mode - invert for white on black */
[data-mode="dark"] [data-wireframe="lo"],
html[data-wireframe="lo"][data-mode="dark"] {
  --wireframe-stroke: oklch(100% 0 0);
  --wireframe-fill: oklch(0% 0 0);
  --wireframe-text: oklch(100% 0 0);
  --wireframe-muted: oklch(70% 0 0);
  --wireframe-accent: oklch(15% 0 0);
}

@media (prefers-color-scheme: dark) {
  html[data-wireframe="lo"]:not([data-mode="light"]),
  [data-wireframe="lo"]:not([data-mode="light"]) {
    --wireframe-stroke: oklch(100% 0 0);
    --wireframe-fill: oklch(0% 0 0);
    --wireframe-text: oklch(100% 0 0);
    --wireframe-muted: oklch(70% 0 0);
    --wireframe-accent: oklch(15% 0 0);
  }
}

/* Lo-fi indicator shows "SKETCH" */
html[data-wireframe="lo"]::before {
  content: "SKETCH";
  background: var(--wireframe-stroke);
  color: var(--wireframe-fill);
}

/* --- Mid-fi: Clean blocks, labeled areas (default behavior) --- */
[data-wireframe="mid"] {
  --font-sans: var(--wf-font-block, 'Flow Block', system-ui);
  --font-serif: var(--wf-font-block, 'Flow Block', system-ui);
  --font-mono: var(--wf-font-block, 'Flow Block', system-ui);
}

html[data-wireframe="mid"]::before {
  content: "WIREFRAME";
}

/* --- Hi-fi: Near-production, subtle hints --- */
[data-wireframe="hi"] {
  --wireframe-stroke: oklch(55% 0 0);
  --wireframe-fill: oklch(98% 0 0);
  --wireframe-text: oklch(25% 0 0);
  --wireframe-muted: oklch(60% 0 0);
  --wireframe-accent: oklch(92% 0 0);
  --wireframe-border: 1px dashed var(--wireframe-stroke);
  /* Keep system fonts for hi-fi */
}

/* Hi-fi dark mode */
[data-mode="dark"] [data-wireframe="hi"],
html[data-wireframe="hi"][data-mode="dark"] {
  --wireframe-stroke: oklch(55% 0 0);
  --wireframe-fill: oklch(15% 0 0);
  --wireframe-text: oklch(85% 0 0);
  --wireframe-muted: oklch(55% 0 0);
  --wireframe-accent: oklch(22% 0 0);
}

@media (prefers-color-scheme: dark) {
  html[data-wireframe="hi"]:not([data-mode="light"]),
  [data-wireframe="hi"]:not([data-mode="light"]) {
    --wireframe-stroke: oklch(55% 0 0);
    --wireframe-fill: oklch(15% 0 0);
    --wireframe-text: oklch(85% 0 0);
    --wireframe-muted: oklch(55% 0 0);
    --wireframe-accent: oklch(22% 0 0);
  }
}

html[data-wireframe="hi"]::before {
  content: "PREVIEW";
  background: var(--wireframe-stroke);
  color: var(--wireframe-fill);
}

/* Hi-fi uses muted grayscale instead of full grayscale */
html[data-wireframe="hi"] {
  filter: grayscale(0.3) saturate(0.7);
}

/* Hi-fi shows subtle image overlay instead of X */
[data-wireframe="hi"] img::after,
[data-wireframe="hi"] picture::after,
[data-wireframe="hi"] video::after {
  background: oklch(from var(--wireframe-accent) l c h / 0.5);
}

/* ============================================== */
/* LABELING SYSTEM                                */
/* ============================================== */

/* Elements with data-wf-label get a label badge */
[data-wireframe] [data-wf-label] {
  position: relative;
}

/* Label badge - positioned at top-left corner */
[data-wireframe] [data-wf-label]::before {
  content: var(--wf-label-text, attr(data-wf-label));
  position: absolute;
  inset-block-start: var(--size-2xs, 4px);
  inset-inline-start: var(--size-2xs, 4px);
  padding: var(--size-3xs, 2px) var(--size-2xs, 4px);
  background: var(--wireframe-label-bg);
  color: var(--wireframe-label-color);
  font-size: var(--font-size-2xs, 10px);
  font-family: system-ui, sans-serif;
  font-weight: 500;
  white-space: nowrap;
  z-index: 1;
  pointer-events: none;
  border-radius: 2px;
}

/* Center label for images and media elements */
[data-wireframe] :is(img, picture, video, iframe, canvas)[data-wf-label] {
  display: flex;
  align-items: center;
  justify-content: center;
}

[data-wireframe] :is(img, picture, video, iframe, canvas)[data-wf-label]::before {
  inset: auto;
  position: relative;
  font-size: var(--font-size-s, 14px);
  padding: var(--size-xs, 8px) var(--size-s, 12px);
}

/* Images with alt text get automatic labels in annotation mode */
[data-wireframe="annotate"] img[alt]:not([data-wf-label])::before {
  content: attr(alt);
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--wireframe-fill);
  color: var(--wireframe-muted);
  font-size: var(--font-size-xs, 12px);
  font-family: system-ui, sans-serif;
  text-align: center;
  padding: var(--size-xs, 8px);
}

/* Lo-fi labels are bolder */
[data-wireframe="lo"] [data-wf-label]::before {
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Hi-fi labels are subtle */
[data-wireframe="hi"] [data-wf-label]::before {
  background: var(--wireframe-muted);
  color: var(--wireframe-fill);
  font-size: var(--font-size-3xs, 9px);
}

/* ============================================== */
/* ENHANCED IMAGE PLACEHOLDERS                    */
/* ============================================== */

/* Show dimensions on hover for images in wireframe mode */
[data-wireframe] img {
  --wf-img-overlay: "";
}

/* Annotation mode shows image dimensions */
[data-wireframe="annotate"] img::after {
  content: var(--wf-img-overlay, "");
  position: absolute;
  inset-block-end: var(--size-2xs, 4px);
  inset-inline-end: var(--size-2xs, 4px);
  padding: var(--size-3xs, 2px) var(--size-2xs, 4px);
  background: var(--wireframe-muted);
  color: var(--wireframe-fill);
  font-size: var(--font-size-3xs, 9px);
  font-family: monospace;
  white-space: nowrap;
  z-index: 1;
  pointer-events: none;
  border-radius: 2px;
}
