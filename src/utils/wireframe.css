/* Wireframe mode: Sketch-like aesthetic for rapid HTML prototyping */
/* Activated by <html data-wireframe> or on any container element */
/*
 * Fidelity levels:
 * - data-wireframe="lo"  : Scribble font, rough borders, pure B&W
 * - data-wireframe="mid" : Block font, dashed borders, grayscale
 * - data-wireframe="hi"  : System fonts, subtle styling, near-production
 * - data-wireframe       : Default/legacy behavior (same as mid)
 * - data-wireframe="annotate" : Show element labels
 */

/* Root variables for wireframe styling - Light mode (default) */
[data-wireframe] {
  --wireframe-stroke: oklch(30% 0 0);
  --wireframe-fill: oklch(98% 0 0);
  --wireframe-text: oklch(15% 0 0);
  --wireframe-muted: oklch(50% 0 0);
  --wireframe-accent: oklch(90% 0 0);
  --wireframe-border: 2px dashed var(--wireframe-stroke);
  --wireframe-label-bg: var(--wireframe-stroke);
  --wireframe-label-color: var(--wireframe-fill);
}

/* Dark mode support via data-mode attribute */
[data-mode="dark"] [data-wireframe],
html[data-wireframe][data-mode="dark"] {
  --wireframe-stroke: oklch(80% 0 0);
  --wireframe-fill: oklch(12% 0 0);
  --wireframe-text: oklch(92% 0 0);
  --wireframe-muted: oklch(65% 0 0);
  --wireframe-accent: oklch(20% 0 0);
}

/* Dark mode support via system preference (auto mode) */
@media (prefers-color-scheme: dark) {
  html[data-wireframe]:not([data-mode="light"]),
  [data-wireframe]:not([data-mode="light"]) {
    --wireframe-stroke: oklch(80% 0 0);
    --wireframe-fill: oklch(12% 0 0);
    --wireframe-text: oklch(92% 0 0);
    --wireframe-muted: oklch(65% 0 0);
    --wireframe-accent: oklch(20% 0 0);
  }
}

/* Wireframe mode indicator */
html[data-wireframe]::before {
  content: "WIREFRAME";
  position: fixed;
  inset-block-end: var(--size-s);
  inset-inline-end: var(--size-s);
  z-index: 99999;
  padding: var(--size-2xs) var(--size-s);
  background: var(--wireframe-stroke);
  color: var(--wireframe-fill);
  font-size: var(--font-size-xs);
  font-weight: 600;
  font-family: system-ui, sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  border-radius: var(--radius-s);
  pointer-events: none;
}

/* Apply grayscale to everything in wireframe mode */
html[data-wireframe] {
  filter: grayscale(1);
}

/* Remove all shadows and decorative effects */
[data-wireframe] * {
  box-shadow: none !important;
  text-shadow: none !important;
}

/* --- Borders: Convert to dashed sketch lines --- */
[data-wireframe] :is(
  article, aside, section, main, nav, header, footer,
  div, form, fieldset,
  layout-card, layout-sidebar, layout-stack, layout-grid, layout-center, layout-cluster, layout-cover, layout-switcher, layout-reel
) {
  border: var(--wireframe-border) !important;
  border-radius: 0 !important;
  background: var(--wireframe-fill) !important;
}

/* Headings: Simple underlines */
[data-wireframe] :is(h1, h2, h3, h4, h5, h6) {
  border-block-end: var(--wireframe-border);
  padding-block-end: var(--size-2xs);
  background: transparent !important;
}

/* Links: Dotted underline only */
[data-wireframe] a {
  color: var(--wireframe-text) !important;
  text-decoration: underline dotted var(--wireframe-stroke) !important;
  background: transparent !important;
}

/* Buttons: Simple outlined boxes */
[data-wireframe] button,
[data-wireframe] [role="button"],
[data-wireframe] input[type="submit"],
[data-wireframe] input[type="button"],
[data-wireframe] .button {
  border: var(--wireframe-border) !important;
  border-radius: 0 !important;
  background: var(--wireframe-fill) !important;
  color: var(--wireframe-text) !important;
}

/* Form inputs: Simple outlined fields */
[data-wireframe] :is(input, textarea, select) {
  border: var(--wireframe-border) !important;
  border-radius: 0 !important;
  background: var(--wireframe-fill) !important;
  color: var(--wireframe-text) !important;
}

/* --- Images: Placeholder boxes with X --- */
/*
 * Images are void elements - can't use ::after on them directly.
 * Strategy:
 * 1. Hide image content with opacity
 * 2. Show X-pattern as background on the image itself
 * 3. Use figure/picture ::after for labels when present
 */

/* Base image styling - hide content, show X pattern */
[data-wireframe] img {
  position: relative;
  opacity: 0.15 !important; /* Fade the actual image significantly */
  border: var(--wireframe-border) !important;
  background: var(--wireframe-fill) !important;
}

/* X-pattern using SVG data URI on the image background */
[data-wireframe] img {
  background-image:
    linear-gradient(
      to bottom right,
      transparent calc(50% - 1px),
      var(--wireframe-stroke) calc(50% - 1px),
      var(--wireframe-stroke) calc(50% + 1px),
      transparent calc(50% + 1px)
    ),
    linear-gradient(
      to top right,
      transparent calc(50% - 1px),
      var(--wireframe-stroke) calc(50% - 1px),
      var(--wireframe-stroke) calc(50% + 1px),
      transparent calc(50% + 1px)
    ) !important;
  background-color: var(--wireframe-fill) !important;
}

/* Lo-fi mode: Completely hide images */
[data-wireframe="lo"] img {
  opacity: 0 !important;
}

/* Hi-fi mode: Show images more clearly */
[data-wireframe="hi"] img {
  opacity: 0.4 !important;
  background-image: none !important;
}

/* Picture and video elements */
[data-wireframe] picture,
[data-wireframe] video,
[data-wireframe] iframe,
[data-wireframe] canvas {
  position: relative;
  background: var(--wireframe-fill) !important;
  border: var(--wireframe-border) !important;
}

/* Figure containers - position for overlay */
[data-wireframe] figure:has(img) {
  position: relative;
}

/* X-pattern overlay on figure elements */
[data-wireframe] figure:has(img)::before {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: none;
  background:
    linear-gradient(
      to bottom right,
      transparent calc(50% - 1px),
      var(--wireframe-stroke) calc(50% - 1px),
      var(--wireframe-stroke) calc(50% + 1px),
      transparent calc(50% + 1px)
    ),
    linear-gradient(
      to top right,
      transparent calc(50% - 1px),
      var(--wireframe-stroke) calc(50% - 1px),
      var(--wireframe-stroke) calc(50% + 1px),
      transparent calc(50% + 1px)
    );
}

/* Don't show double X on hi-fi */
[data-wireframe="hi"] figure:has(img)::before {
  background: oklch(from var(--wireframe-fill) l c h / 0.3);
}

/* Picture element X-pattern */
[data-wireframe] picture::after {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: none;
  background:
    linear-gradient(
      to bottom right,
      transparent calc(50% - 1px),
      var(--wireframe-stroke) calc(50% - 1px),
      var(--wireframe-stroke) calc(50% + 1px),
      transparent calc(50% + 1px)
    ),
    linear-gradient(
      to top right,
      transparent calc(50% - 1px),
      var(--wireframe-stroke) calc(50% - 1px),
      var(--wireframe-stroke) calc(50% + 1px),
      transparent calc(50% + 1px)
    );
}

/* Tables: Simple grid lines */
[data-wireframe] table {
  border-collapse: collapse;
  border: var(--wireframe-border) !important;
}

[data-wireframe] :is(th, td) {
  border: 1px dashed var(--wireframe-stroke) !important;
  background: var(--wireframe-fill) !important;
}

[data-wireframe] th {
  background: var(--wireframe-accent) !important;
}

/* Cards and interactive elements */
[data-wireframe] :is(details, dialog) {
  border: var(--wireframe-border) !important;
  border-radius: 0 !important;
  background: var(--wireframe-fill) !important;
}

[data-wireframe] summary {
  border-block-end: 1px dashed var(--wireframe-stroke) !important;
}

/* Lists: Simple markers */
[data-wireframe] :is(ul, ol) {
  list-style: square !important;
}

[data-wireframe] ul {
  list-style: "- " !important;
}

/* Blockquotes: Left border only */
[data-wireframe] blockquote {
  border: none !important;
  border-inline-start: 4px solid var(--wireframe-stroke) !important;
  background: transparent !important;
}

/* Code blocks: Simple box */
[data-wireframe] :is(pre, code) {
  border: 1px dashed var(--wireframe-stroke) !important;
  border-radius: 0 !important;
  background: var(--wireframe-accent) !important;
  color: var(--wireframe-text) !important;
}

/* Horizontal rules: Simple dashed line */
[data-wireframe] hr {
  border: none !important;
  border-block-start: var(--wireframe-border) !important;
  background: transparent !important;
}

/* --- Annotations: Label elements with their tag name --- */
/* Optional: Add data-wireframe="annotate" for element labels */
[data-wireframe="annotate"] *:not(script):not(style):not(br):not(hr)::before {
  content: "<" attr(data-label, "") ">";
  position: absolute;
  inset-block-start: -1.2em;
  inset-inline-start: 0;
  font-size: 10px;
  font-family: monospace;
  color: var(--wireframe-muted);
  pointer-events: none;
}

/* Label common elements automatically when annotating */
[data-wireframe="annotate"] header::before { content: "<header>"; }
[data-wireframe="annotate"] nav::before { content: "<nav>"; }
[data-wireframe="annotate"] main::before { content: "<main>"; }
[data-wireframe="annotate"] aside::before { content: "<aside>"; }
[data-wireframe="annotate"] footer::before { content: "<footer>"; }
[data-wireframe="annotate"] article::before { content: "<article>"; }
[data-wireframe="annotate"] section::before { content: "<section>"; }

/* --- Scoped wireframe mode --- */
/* Apply wireframe only to a specific container */
:not(html)[data-wireframe] {
  /* Don't apply grayscale filter to containers, only html */
  filter: none;
}

/* Container-scoped mode indicator */
:not(html)[data-wireframe]::before {
  content: "wireframe";
  display: block;
  padding: var(--size-3xs) var(--size-2xs);
  margin-block-end: var(--size-xs);
  background: var(--wireframe-stroke);
  color: var(--wireframe-fill);
  font-size: var(--font-size-xs);
  font-family: monospace;
  width: fit-content;
}

/* --- Reduced motion support --- */
/* Wireframe mode is mostly static, but ensure no transitions */
@media (prefers-reduced-motion: reduce) {
  [data-wireframe] * {
    transition: none !important;
    animation: none !important;
  }
}

/* ============================================== */
/* FIDELITY LEVELS                                */
/* ============================================== */

/* --- Lo-fi: Maximum abstraction, sketch aesthetic --- */
/* Pure B&W for maximum contrast in both light and dark modes */
[data-wireframe="lo"] {
  --wireframe-stroke: oklch(0% 0 0);
  --wireframe-fill: oklch(100% 0 0);
  --wireframe-text: oklch(0% 0 0);
  --wireframe-muted: oklch(40% 0 0);
  --wireframe-accent: oklch(95% 0 0);
  --wireframe-border: 2px solid var(--wireframe-stroke);
  --font-sans: var(--wf-font-scribble, 'Redacted Script', cursive);
  --font-serif: var(--wf-font-scribble, 'Redacted Script', cursive);
  --font-mono: var(--wf-font-scribble, 'Redacted Script', cursive);
}

/* Lo-fi font application - apply scribble font to all text elements */
html[data-wireframe="lo"],
html[data-wireframe="lo"] body,
[data-wireframe="lo"] :is(
  p, span, a, li, td, th, label, legend,
  h1, h2, h3, h4, h5, h6,
  button, input, textarea, select
) {
  font-family: var(--wf-font-scribble, 'Redacted Script', cursive) !important;
}

/* Lo-fi dark mode - invert for white on black */
[data-mode="dark"] [data-wireframe="lo"],
html[data-wireframe="lo"][data-mode="dark"] {
  --wireframe-stroke: oklch(100% 0 0);
  --wireframe-fill: oklch(0% 0 0);
  --wireframe-text: oklch(100% 0 0);
  --wireframe-muted: oklch(70% 0 0);
  --wireframe-accent: oklch(15% 0 0);
}

@media (prefers-color-scheme: dark) {
  html[data-wireframe="lo"]:not([data-mode="light"]),
  [data-wireframe="lo"]:not([data-mode="light"]) {
    --wireframe-stroke: oklch(100% 0 0);
    --wireframe-fill: oklch(0% 0 0);
    --wireframe-text: oklch(100% 0 0);
    --wireframe-muted: oklch(70% 0 0);
    --wireframe-accent: oklch(15% 0 0);
  }
}

/* Lo-fi indicator shows "SKETCH" */
html[data-wireframe="lo"]::before {
  content: "SKETCH";
  background: var(--wireframe-stroke);
  color: var(--wireframe-fill);
}

/* --- Mid-fi: Clean blocks, labeled areas (default behavior) --- */
[data-wireframe="mid"] {
  --font-sans: var(--wf-font-block, 'Flow Block', system-ui);
  --font-serif: var(--wf-font-block, 'Flow Block', system-ui);
  --font-mono: var(--wf-font-block, 'Flow Block', system-ui);
}

/* Mid-fi font application - apply block font to all text elements */
html[data-wireframe="mid"],
html[data-wireframe="mid"] body,
[data-wireframe="mid"] :is(
  p, span, a, li, td, th, label, legend,
  h1, h2, h3, h4, h5, h6,
  button, input, textarea, select
) {
  font-family: var(--wf-font-block, 'Flow Block', system-ui) !important;
}

html[data-wireframe="mid"]::before {
  content: "WIREFRAME";
}

/* --- Hi-fi: Near-production, subtle hints --- */
[data-wireframe="hi"] {
  --wireframe-stroke: oklch(55% 0 0);
  --wireframe-fill: oklch(98% 0 0);
  --wireframe-text: oklch(25% 0 0);
  --wireframe-muted: oklch(60% 0 0);
  --wireframe-accent: oklch(92% 0 0);
  --wireframe-border: 1px dashed var(--wireframe-stroke);
  /* Keep system fonts for hi-fi */
}

/* Hi-fi dark mode */
[data-mode="dark"] [data-wireframe="hi"],
html[data-wireframe="hi"][data-mode="dark"] {
  --wireframe-stroke: oklch(55% 0 0);
  --wireframe-fill: oklch(15% 0 0);
  --wireframe-text: oklch(85% 0 0);
  --wireframe-muted: oklch(55% 0 0);
  --wireframe-accent: oklch(22% 0 0);
}

@media (prefers-color-scheme: dark) {
  html[data-wireframe="hi"]:not([data-mode="light"]),
  [data-wireframe="hi"]:not([data-mode="light"]) {
    --wireframe-stroke: oklch(55% 0 0);
    --wireframe-fill: oklch(15% 0 0);
    --wireframe-text: oklch(85% 0 0);
    --wireframe-muted: oklch(55% 0 0);
    --wireframe-accent: oklch(22% 0 0);
  }
}

html[data-wireframe="hi"]::before {
  content: "PREVIEW";
  background: var(--wireframe-stroke);
  color: var(--wireframe-fill);
}

/* Hi-fi uses muted grayscale instead of full grayscale */
html[data-wireframe="hi"] {
  filter: grayscale(0.3) saturate(0.7);
}

/* Hi-fi shows subtle overlay instead of X on picture elements */
[data-wireframe="hi"] picture::after {
  background: oklch(from var(--wireframe-accent) l c h / 0.5);
}

/* ============================================== */
/* LABELING SYSTEM                                */
/* ============================================== */

/* Elements with data-wf-label get a label badge */
[data-wireframe] [data-wf-label] {
  position: relative;
}

/* Label badge - positioned at top-left corner */
[data-wireframe] [data-wf-label]::before {
  content: var(--wf-label-text, attr(data-wf-label));
  position: absolute;
  inset-block-start: var(--size-2xs, 4px);
  inset-inline-start: var(--size-2xs, 4px);
  padding: var(--size-3xs, 2px) var(--size-2xs, 4px);
  background: var(--wireframe-label-bg);
  color: var(--wireframe-label-color);
  font-size: var(--font-size-2xs, 10px);
  font-family: system-ui, sans-serif;
  font-weight: 500;
  white-space: nowrap;
  z-index: 1;
  pointer-events: none;
  border-radius: 2px;
}

/*
 * Image labels work via figure container
 * Note: <img> elements cannot have ::before/::after pseudo-elements.
 * Use <figure> wrapper or JavaScript for standalone images.
 */

/* Figure with labeled image - show label via ::after */
[data-wireframe] figure:has(img[data-wf-label])::after,
[data-wireframe] figure:has(img[alt]):not(:has(img[data-wf-label]))::after {
  content: attr(data-wf-img-label);
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2;
  color: var(--wireframe-text);
  font-size: var(--font-size-s, 14px);
  font-family: system-ui, sans-serif;
  font-weight: 500;
  text-align: center;
  padding: var(--size-xs, 8px);
  pointer-events: none;
}

/* Picture element labels */
[data-wireframe] picture[data-wf-label]::before {
  content: var(--wf-label-text, attr(data-wf-label));
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2;
  color: var(--wireframe-text);
  font-size: var(--font-size-s, 14px);
  font-family: system-ui, sans-serif;
  font-weight: 500;
  pointer-events: none;
}

/* Lo-fi labels are bolder */
[data-wireframe="lo"] [data-wf-label]::before {
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Hi-fi labels are subtle */
[data-wireframe="hi"] [data-wf-label]::before {
  background: var(--wireframe-muted);
  color: var(--wireframe-fill);
  font-size: var(--font-size-3xs, 9px);
}

/* ============================================== */
/* ENHANCED IMAGE PLACEHOLDERS                    */
/* ============================================== */

/*
 * Note: Image dimensions overlay requires JavaScript since
 * <img> elements cannot have pseudo-elements.
 * The wireframe.js labelElements() function handles this.
 */
